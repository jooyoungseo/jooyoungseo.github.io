<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Appendix I: R Source Code Used for Data Analyses | Discovering Informal Learning Cultures of Blind Individuals Pursuing STEM Disciplines</title>
  <meta name="description" content="JooYoung Seo’s dissertation submitted to the Pennsylvania State University" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Appendix I: R Source Code Used for Data Analyses | Discovering Informal Learning Cultures of Blind Individuals Pursuing STEM Disciplines" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://www.jooyoungseo.com/dissertation" />
  
  <meta property="og:description" content="JooYoung Seo’s dissertation submitted to the Pennsylvania State University" />
  <meta name="github-repo" content="jooyoungseo/dissertation" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Appendix I: R Source Code Used for Data Analyses | Discovering Informal Learning Cultures of Blind Individuals Pursuing STEM Disciplines" />
  
  <meta name="twitter:description" content="JooYoung Seo’s dissertation submitted to the Pennsylvania State University" />
  

<meta name="author" content="JooYoung Seo" />


<meta name="date" content="2021-05-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="app-table.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#background"><i class="fa fa-check"></i><b>1.1</b> Background and Importance of the Topic</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#gap"><i class="fa fa-check"></i><b>1.2</b> Research Problem: A Knowledge Gap</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#purpose"><i class="fa fa-check"></i><b>1.3</b> Purpose of the Study</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#rq"><i class="fa fa-check"></i><b>1.4</b> Research Questions</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#quan-rq"><i class="fa fa-check"></i><b>1.4.1</b> Quantitative Research Questions</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#qual-rq"><i class="fa fa-check"></i><b>1.4.2</b> Qualitative Research Questions</a></li>
<li class="chapter" data-level="1.4.3" data-path="intro.html"><a href="intro.html#mixed-rq"><i class="fa fa-check"></i><b>1.4.3</b> Hybrid Mixed Methods Question</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#significance"><i class="fa fa-check"></i><b>1.5</b> Significance and Value of the Study</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#limitation"><i class="fa fa-check"></i><b>1.6</b> Possible Study Limitations</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#intro-summary"><i class="fa fa-check"></i><b>1.7</b> Chapter Summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lit-review.html"><a href="lit-review.html"><i class="fa fa-check"></i><b>2</b> Literature Review</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lit-review.html"><a href="lit-review.html#lit-intro"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="lit-review.html"><a href="lit-review.html#definition"><i class="fa fa-check"></i><b>2.2</b> What is STEM?</a></li>
<li class="chapter" data-level="2.3" data-path="lit-review.html"><a href="lit-review.html#bibliometrics"><i class="fa fa-check"></i><b>2.3</b> Growing Trends of STEM Learning</a></li>
<li class="chapter" data-level="2.4" data-path="lit-review.html"><a href="lit-review.html#theory-framework"><i class="fa fa-check"></i><b>2.4</b> Theoretical Frameworks</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="lit-review.html"><a href="lit-review.html#ecological-model"><i class="fa fa-check"></i><b>2.4.1</b> Ecological Model of STEM Education</a></li>
<li class="chapter" data-level="2.4.2" data-path="lit-review.html"><a href="lit-review.html#disability-model"><i class="fa fa-check"></i><b>2.4.2</b> Political/Relational Model of Disability</a></li>
<li class="chapter" data-level="2.4.3" data-path="lit-review.html"><a href="lit-review.html#socioculture"><i class="fa fa-check"></i><b>2.4.3</b> Sociocultural Perspective towards Collaborative Shared Cognition</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="lit-review.html"><a href="lit-review.html#stem-issue"><i class="fa fa-check"></i><b>2.5</b> Three Issues in Current STEM Education: Equity; Inclusivity; and Accessibility</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="lit-review.html"><a href="lit-review.html#equity"><i class="fa fa-check"></i><b>2.5.1</b> Equity Issue of Gendered Disparity</a></li>
<li class="chapter" data-level="2.5.2" data-path="lit-review.html"><a href="lit-review.html#inclusivity"><i class="fa fa-check"></i><b>2.5.2</b> Inclusivity Issue of Ethnic/Racial Diversity</a></li>
<li class="chapter" data-level="2.5.3" data-path="lit-review.html"><a href="lit-review.html#accessibility"><i class="fa fa-check"></i><b>2.5.3</b> Accessibility Issue of Discriminating Dis/Abilities</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="lit-review.html"><a href="lit-review.html#overview-ca"><i class="fa fa-check"></i><b>2.6</b> Overview of Computer-Assisted Text Analysis</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="lit-review.html"><a href="lit-review.html#supervised"><i class="fa fa-check"></i><b>2.6.1</b> Deductive Text Classification Using Supervised Machine Learning</a></li>
<li class="chapter" data-level="2.6.2" data-path="lit-review.html"><a href="lit-review.html#unsupervised"><i class="fa fa-check"></i><b>2.6.2</b> Inductive Text Clustering Using Unsupervised Machine Learning</a></li>
<li class="chapter" data-level="2.6.3" data-path="lit-review.html"><a href="lit-review.html#stm"><i class="fa fa-check"></i><b>2.6.3</b> Abductive Text Interpretation Using Structural Topic modeling</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="lit-review.html"><a href="lit-review.html#lit-summary"><i class="fa fa-check"></i><b>2.7</b> Chapter Summary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>3</b> Methods</a>
<ul>
<li class="chapter" data-level="3.1" data-path="methods.html"><a href="methods.html#methods-intro"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="methods.html"><a href="methods.html#rd"><i class="fa fa-check"></i><b>3.2</b> Research Design</a></li>
<li class="chapter" data-level="3.3" data-path="methods.html"><a href="methods.html#research-ethics-and-procedures"><i class="fa fa-check"></i><b>3.3</b> Research Ethics and Procedures</a></li>
<li class="chapter" data-level="3.4" data-path="methods.html"><a href="methods.html#methods-rq"><i class="fa fa-check"></i><b>3.4</b> Research Questions</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="intro.html"><a href="intro.html#quan-rq"><i class="fa fa-check"></i><b>3.4.1</b> Quantitative Research Questions</a></li>
<li class="chapter" data-level="3.4.2" data-path="intro.html"><a href="intro.html#qual-rq"><i class="fa fa-check"></i><b>3.4.2</b> Qualitative Research Questions</a></li>
<li class="chapter" data-level="3.4.3" data-path="intro.html"><a href="intro.html#mixed-rq"><i class="fa fa-check"></i><b>3.4.3</b> Hybrid Mixed Methods Question</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="methods.html"><a href="methods.html#setting-and-sample"><i class="fa fa-check"></i><b>3.5</b> Setting and Sample</a></li>
<li class="chapter" data-level="3.6" data-path="methods.html"><a href="methods.html#positionality"><i class="fa fa-check"></i><b>3.6</b> Positionality</a></li>
<li class="chapter" data-level="3.7" data-path="methods.html"><a href="methods.html#dc"><i class="fa fa-check"></i><b>3.7</b> Data Collection</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="methods.html"><a href="methods.html#dc-participant"><i class="fa fa-check"></i><b>3.7.1</b> Computational Participant-Observation</a></li>
<li class="chapter" data-level="3.7.2" data-path="methods.html"><a href="methods.html#dc-interview"><i class="fa fa-check"></i><b>3.7.2</b> Semi-Structured Interviews</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="methods.html"><a href="methods.html#da"><i class="fa fa-check"></i><b>3.8</b> Data Analysis Procedure</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="methods.html"><a href="methods.html#extraction"><i class="fa fa-check"></i><b>3.8.1</b> Phase I: Data Extraction</a></li>
<li class="chapter" data-level="3.8.2" data-path="methods.html"><a href="methods.html#transformation"><i class="fa fa-check"></i><b>3.8.2</b> Phase II and III: Data Cleaning and Transformation</a></li>
<li class="chapter" data-level="3.8.3" data-path="methods.html"><a href="methods.html#tm"><i class="fa fa-check"></i><b>3.8.3</b> Phase IV: Text Mining</a></li>
<li class="chapter" data-level="3.8.4" data-path="methods.html"><a href="methods.html#results"><i class="fa fa-check"></i><b>3.8.4</b> Phase V: Results Evaluation and Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="methods.html"><a href="methods.html#methods-summary"><i class="fa fa-check"></i><b>3.9</b> Chapter Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="findings.html"><a href="findings.html"><i class="fa fa-check"></i><b>4</b> Research Findings</a>
<ul>
<li class="chapter" data-level="4.1" data-path="findings.html"><a href="findings.html#findings-intro"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="findings.html"><a href="findings.html#findings-quan-rq"><i class="fa fa-check"></i><b>4.2</b> Results from the Computational Participant-Observation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="findings.html"><a href="findings.html#findings-quan-rq-descriptive"><i class="fa fa-check"></i><b>4.2.1</b> Descriptive Questions</a></li>
<li class="chapter" data-level="4.2.2" data-path="findings.html"><a href="findings.html#findings-quan-rq-network"><i class="fa fa-check"></i><b>4.2.2</b> Semantic Network Questions</a></li>
<li class="chapter" data-level="4.2.3" data-path="findings.html"><a href="findings.html#findings-quan-rq-stm"><i class="fa fa-check"></i><b>4.2.3</b> Data Clustering Questions</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="findings.html"><a href="findings.html#findings-qual-rq"><i class="fa fa-check"></i><b>4.3</b> Findings from Semi-Structured Interviews</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="findings.html"><a href="findings.html#sdl"><i class="fa fa-check"></i><b>4.3.1</b> Self-Directed Learning Over Lectures</a></li>
<li class="chapter" data-level="4.3.2" data-path="findings.html"><a href="findings.html#linear-verbal-learning"><i class="fa fa-check"></i><b>4.3.2</b> Linear Verbal Learning</a></li>
<li class="chapter" data-level="4.3.3" data-path="findings.html"><a href="findings.html#positive-attitudes"><i class="fa fa-check"></i><b>4.3.3</b> Positive Attitudes</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="findings.html"><a href="findings.html#findings-mixed-rq"><i class="fa fa-check"></i><b>4.4</b> Comprehensive Results</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="findings.html"><a href="findings.html#findings-mixed-rq-hybrid"><i class="fa fa-check"></i><b>4.4.1</b> Mixed RQ: What results emerge from comparing the qualitative interviews about the STEM-learning experiences of blind individuals with the computational outcomes derived from the STEM-oriented listservs?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="findings.html"><a href="findings.html#findings-summary"><i class="fa fa-check"></i><b>4.5</b> Chapter Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>5</b> Discussion and Conclusions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="conclusion.html"><a href="conclusion.html#conclusion-intro"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="conclusion.html"><a href="conclusion.html#discussions-and-implications"><i class="fa fa-check"></i><b>5.2</b> Discussions and Implications</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="conclusion.html"><a href="conclusion.html#disconnected-mesosystem"><i class="fa fa-check"></i><b>5.2.1</b> Disconnected Mesosystem</a></li>
<li class="chapter" data-level="5.2.2" data-path="conclusion.html"><a href="conclusion.html#limited-modality-of-current-assistive-technologies"><i class="fa fa-check"></i><b>5.2.2</b> Limited Modality of Current Assistive Technologies</a></li>
<li class="chapter" data-level="5.2.3" data-path="conclusion.html"><a href="conclusion.html#lacking-central-resources"><i class="fa fa-check"></i><b>5.2.3</b> Lacking Central Resources</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="conclusion.html"><a href="conclusion.html#conclusions"><i class="fa fa-check"></i><b>5.3</b> Conclusions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="conclusion.html"><a href="conclusion.html#summary-and-contribution"><i class="fa fa-check"></i><b>5.3.1</b> Summary and Contribution</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="conclusion.html"><a href="conclusion.html#suggestion"><i class="fa fa-check"></i><b>5.4</b> Suggestions for Future Research</a></li>
<li class="chapter" data-level="5.5" data-path="conclusion.html"><a href="conclusion.html#acknowledgements"><i class="fa fa-check"></i><b>5.5</b> Acknowledgements</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="app-irb.html"><a href="app-irb.html"><i class="fa fa-check"></i><b>A</b> Determination Letter from the Office for Research Protections</a></li>
<li class="chapter" data-level="B" data-path="app-nfb.html"><a href="app-nfb.html"><i class="fa fa-check"></i><b>B</b> The National Federation of the Blind (NFB) Materials</a>
<ul>
<li class="chapter" data-level="B.1" data-path="app-nfb.html"><a href="app-nfb.html#gate-keeper"><i class="fa fa-check"></i><b>B.1</b> Contact with a Gatekeeper of the NFB Community</a></li>
<li class="chapter" data-level="B.2" data-path="app-nfb.html"><a href="app-nfb.html#nfb-research-form"><i class="fa fa-check"></i><b>B.2</b> Research Participant Solicitation Request Form</a></li>
<li class="chapter" data-level="B.3" data-path="app-nfb.html"><a href="app-nfb.html#nfb-approval"><i class="fa fa-check"></i><b>B.3</b> Official Approvals from the NFB Research Advisory Council</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="app-interview.html"><a href="app-interview.html"><i class="fa fa-check"></i><b>C</b> Interview Materials</a>
<ul>
<li class="chapter" data-level="C.1" data-path="app-interview.html"><a href="app-interview.html#recruitment-materials"><i class="fa fa-check"></i><b>C.1</b> Recruitment Materials</a></li>
<li class="chapter" data-level="C.2" data-path="app-interview.html"><a href="app-interview.html#consent-form"><i class="fa fa-check"></i><b>C.2</b> Interview Consent Form</a></li>
<li class="chapter" data-level="C.3" data-path="app-interview.html"><a href="app-interview.html#interview-protocol"><i class="fa fa-check"></i><b>C.3</b> Semi-Structured Interview Protocol</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="app-transcripts.html"><a href="app-transcripts.html"><i class="fa fa-check"></i><b>D</b> Interview Transcripts</a>
<ul>
<li class="chapter" data-level="D.1" data-path="app-transcripts.html"><a href="app-transcripts.html#p1"><i class="fa fa-check"></i><b>D.1</b> Participant 1</a></li>
<li class="chapter" data-level="D.2" data-path="app-transcripts.html"><a href="app-transcripts.html#p2"><i class="fa fa-check"></i><b>D.2</b> Participant 2</a></li>
<li class="chapter" data-level="D.3" data-path="app-transcripts.html"><a href="app-transcripts.html#p3"><i class="fa fa-check"></i><b>D.3</b> Participant 3</a></li>
<li class="chapter" data-level="D.4" data-path="app-transcripts.html"><a href="app-transcripts.html#p4"><i class="fa fa-check"></i><b>D.4</b> Participant 4</a></li>
<li class="chapter" data-level="D.5" data-path="app-transcripts.html"><a href="app-transcripts.html#p5"><i class="fa fa-check"></i><b>D.5</b> Participant 5</a></li>
<li class="chapter" data-level="D.6" data-path="app-transcripts.html"><a href="app-transcripts.html#p6"><i class="fa fa-check"></i><b>D.6</b> Participant 6</a></li>
<li class="chapter" data-level="D.7" data-path="app-transcripts.html"><a href="app-transcripts.html#p7"><i class="fa fa-check"></i><b>D.7</b> Participant 7</a></li>
<li class="chapter" data-level="D.8" data-path="app-transcripts.html"><a href="app-transcripts.html#p8"><i class="fa fa-check"></i><b>D.8</b> Participant 8</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="app-shell.html"><a href="app-shell.html"><i class="fa fa-check"></i><b>E</b> Unix Shell Commands for Data Extraction</a></li>
<li class="chapter" data-level="F" data-path="appE.html"><a href="appE.html"><i class="fa fa-check"></i><b>F</b> R Script Used for Text Mining</a></li>
<li class="chapter" data-level="G" data-path="app-cleaning.html"><a href="app-cleaning.html"><i class="fa fa-check"></i><b>G</b> R Script Used for Data Cleaning and Transformation</a></li>
<li class="chapter" data-level="H" data-path="app-table.html"><a href="app-table.html"><i class="fa fa-check"></i><b>H</b> Supplementary Tables</a>
<ul>
<li class="chapter" data-level="H.1" data-path="app-table.html"><a href="app-table.html#app-table-tfidf"><i class="fa fa-check"></i><b>H.1</b> Table for Term Frequency-Inverse Document Frequency</a></li>
<li class="chapter" data-level="H.2" data-path="app-table.html"><a href="app-table.html#app-table-pair"><i class="fa fa-check"></i><b>H.2</b> Tables for Co-Occurrence Network Analysis</a></li>
<li class="chapter" data-level="H.3" data-path="app-table.html"><a href="app-table.html#app-table-corr"><i class="fa fa-check"></i><b>H.3</b> Tables for Correlation Network Analysis</a></li>
<li class="chapter" data-level="H.4" data-path="app-table.html"><a href="app-table.html#app-table-bigram"><i class="fa fa-check"></i><b>H.4</b> Tables for Bigram Network Analysis</a></li>
<li class="chapter" data-level="H.5" data-path="app-table.html"><a href="app-table.html#app-table-stm"><i class="fa fa-check"></i><b>H.5</b> Tables for Structural Topic Models</a></li>
</ul></li>
<li class="chapter" data-level="I" data-path="app-code.html"><a href="app-code.html"><i class="fa fa-check"></i><b>I</b> R Source Code Used for Data Analyses</a>
<ul>
<li class="chapter" data-level="I.1" data-path="app-code.html"><a href="app-code.html#app-helper-function"><i class="fa fa-check"></i><b>I.1</b> Customized helper functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Discovering Informal Learning Cultures of Blind Individuals Pursuing STEM Disciplines</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="app-code" class="section level1" number="14">
<h1><span class="header-section-number">Appendix I:</span> R Source Code Used for Data Analyses</h1>
<div id="app-helper-function" class="section level2" number="14.1">
<h2><span class="header-section-number">I.1</span> Customized helper functions</h2>
<p>The following custom R scripts were written to calculate some descriptive statistics (see Chapter <a href="findings.html#quan-rq-1-1">4.2.1.1</a>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="app-code.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-2"><a href="app-code.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mboxr)</span>
<span id="cb4-3"><a href="app-code.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ezpickr)</span>
<span id="cb4-4"><a href="app-code.html#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="app-code.html#cb4-5" aria-hidden="true" tabindex="-1"></a>is_thread <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-6"><a href="app-code.html#cb4-6" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">&quot;num_discussants&quot;</span>] <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb4-7"><a href="app-code.html#cb4-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-8"><a href="app-code.html#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="app-code.html#cb4-9" aria-hidden="true" tabindex="-1"></a>num_thread <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-10"><a href="app-code.html#cb4-10" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="app-code.html#cb4-11" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(num_discussants <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="app-code.html#cb4-12" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(message_ID) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="app-code.html#cb4-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>()</span>
<span id="cb4-14"><a href="app-code.html#cb4-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-15"><a href="app-code.html#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="app-code.html#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove carriage return and trim white spaces in subject line</span></span>
<span id="cb4-17"><a href="app-code.html#cb4-17" aria-hidden="true" tabindex="-1"></a>trim_subject <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-18"><a href="app-code.html#cb4-18" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-19"><a href="app-code.html#cb4-19" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">subject =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="at">string =</span> subject, <span class="at">pattern =</span> <span class="st">&quot;[[:cntrl:]]+&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-20"><a href="app-code.html#cb4-20" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">subject =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="at">string =</span> subject, <span class="at">pattern =</span> <span class="st">&quot;[[:space:]]+&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot; &quot;</span>))</span>
<span id="cb4-21"><a href="app-code.html#cb4-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-22"><a href="app-code.html#cb4-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-23"><a href="app-code.html#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Trim out unnecessary whitespaces and control characters in content</span></span>
<span id="cb4-24"><a href="app-code.html#cb4-24" aria-hidden="true" tabindex="-1"></a>trim_content <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-25"><a href="app-code.html#cb4-25" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-26"><a href="app-code.html#cb4-26" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">content =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="at">string =</span> content, <span class="at">pattern =</span> <span class="st">&quot;[ </span><span class="sc">\\</span><span class="st">t]+&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot; &quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-27"><a href="app-code.html#cb4-27" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">content =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="at">string =</span> content, <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n+&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-28"><a href="app-code.html#cb4-28" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">content =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="at">string =</span> content, <span class="at">pattern =</span> <span class="st">&quot;((?&lt;=[</span><span class="sc">\\</span><span class="st">n</span><span class="sc">\\</span><span class="st">r])</span><span class="sc">\\</span><span class="st">s+)|(</span><span class="sc">\\</span><span class="st">s+(?=[</span><span class="sc">\\</span><span class="st">n</span><span class="sc">\\</span><span class="st">r]))&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb4-29"><a href="app-code.html#cb4-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-30"><a href="app-code.html#cb4-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-31"><a href="app-code.html#cb4-31" aria-hidden="true" tabindex="-1"></a>remove_signoff <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-32"><a href="app-code.html#cb4-32" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-33"><a href="app-code.html#cb4-33" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">content =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="at">string =</span> content, <span class="at">pattern =</span> <span class="st">&quot;((?&lt;=[[:cntrl:]])(([Bb]est|[Kk]ind|[Ss]incere|[Ww]arm(est)?) )?([Rr]egard[s]?|[Ww]ish(es)?)[[:punct:]]?(</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">w+){0,2}[[:cntrl:]][[:cntrl:][:print:]]*)|((?&lt;=[[:cntrl:]])([Yy]our[s]? )?([Ss]incerely|[Tt]ruly|[Ff]aithfully|[Cc]ordially|[Rr]espectfully|[Aa]ppreciatively|[Kk]indly|[Ww]armly)[[:punct:]]?(</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">w+){0,2}[[:cntrl:]][[:cntrl:][:print:]]*)|((?&lt;=[[:cntrl:]])(([Aa]ll the|[Vv]ery) )?[Bb]est[[:punct:]]?(</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">w+){0,2}[[:cntrl:]][[:cntrl:][:print:]]*)|(</span><span class="sc">\\</span><span class="st">n-+[[:print:]]*</span><span class="sc">\\</span><span class="st">n*$)|(</span><span class="sc">\\</span><span class="st">nCheers[[:punct:]]?(</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">w+){0,2}</span><span class="sc">\\</span><span class="st">n+[[:cntrl:][:punct:]]*)|(</span><span class="sc">\\</span><span class="st">nMany thanks[[:punct:]]?(</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">w+){0,2}</span><span class="sc">\\</span><span class="st">n+[[:cntrl:][:punct:]]*)|(Sent from my iP(hone|ad)[[:cntrl:][:print:]]*)|(</span><span class="sc">\\</span><span class="st">nTake care[[:punct:]]?(</span><span class="sc">\\</span><span class="st">s</span><span class="sc">\\</span><span class="st">w+){0,2}</span><span class="sc">\\</span><span class="st">n+[[:cntrl:][:punct:]]*)&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb4-34"><a href="app-code.html#cb4-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-35"><a href="app-code.html#cb4-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-36"><a href="app-code.html#cb4-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Experimental function: literally filter out messages having &quot;Digest&quot; string in subject line.</span></span>
<span id="cb4-37"><a href="app-code.html#cb4-37" aria-hidden="true" tabindex="-1"></a>remove_digest <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-38"><a href="app-code.html#cb4-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(subject, <span class="st">&quot;Digest,&quot;</span>)))</span>
<span id="cb4-39"><a href="app-code.html#cb4-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-40"><a href="app-code.html#cb4-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-41"><a href="app-code.html#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Node df</span></span>
<span id="cb4-42"><a href="app-code.html#cb4-42" aria-hidden="true" tabindex="-1"></a>create_node_df <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-43"><a href="app-code.html#cb4-43" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb4-44"><a href="app-code.html#cb4-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">id =</span> df<span class="sc">$</span>message_ID,</span>
<span id="cb4-45"><a href="app-code.html#cb4-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">label =</span> df<span class="sc">$</span>name</span>
<span id="cb4-46"><a href="app-code.html#cb4-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-47"><a href="app-code.html#cb4-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-48"><a href="app-code.html#cb4-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-49"><a href="app-code.html#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="co"># edge df</span></span>
<span id="cb4-50"><a href="app-code.html#cb4-50" aria-hidden="true" tabindex="-1"></a>create_edge_df <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-51"><a href="app-code.html#cb4-51" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb4-52"><a href="app-code.html#cb4-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">from =</span> df<span class="sc">$</span>message_ID,</span>
<span id="cb4-53"><a href="app-code.html#cb4-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">to =</span> df<span class="sc">$</span>in_reply_to</span>
<span id="cb4-54"><a href="app-code.html#cb4-54" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-55"><a href="app-code.html#cb4-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-56"><a href="app-code.html#cb4-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-57"><a href="app-code.html#cb4-57" aria-hidden="true" tabindex="-1"></a>num_discussants <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-58"><a href="app-code.html#cb4-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Making a new variable (num_discussants) for calculating the number of discussants of each message.</span></span>
<span id="cb4-59"><a href="app-code.html#cb4-59" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-60"><a href="app-code.html#cb4-60" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">num_discussants =</span> (<span class="dv">1</span> <span class="sc">+</span> stringr<span class="sc">::</span><span class="fu">str_count</span>(references, <span class="st">&quot;@&quot;</span>)), <span class="at">num_discussants =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(num_discussants), <span class="dv">1</span>, num_discussants))</span>
<span id="cb4-61"><a href="app-code.html#cb4-61" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-62"><a href="app-code.html#cb4-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-63"><a href="app-code.html#cb4-63" aria-hidden="true" tabindex="-1"></a><span class="co"># This function must be fixed later:</span></span>
<span id="cb4-64"><a href="app-code.html#cb4-64" aria-hidden="true" tabindex="-1"></a>range_from_to <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">from =</span> <span class="cn">NULL</span>, <span class="at">to =</span> <span class="cn">NULL</span>) {</span>
<span id="cb4-65"><a href="app-code.html#cb4-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Only include the specified time period:</span></span>
<span id="cb4-66"><a href="app-code.html#cb4-66" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-67"><a href="app-code.html#cb4-67" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(date <span class="sc">&gt;=</span> lubridate<span class="sc">::</span><span class="fu">date</span>(from) <span class="sc">&amp;</span> date <span class="sc">&lt;</span> lubridate<span class="sc">::</span><span class="fu">date</span>(to))</span>
<span id="cb4-68"><a href="app-code.html#cb4-68" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-69"><a href="app-code.html#cb4-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-70"><a href="app-code.html#cb4-70" aria-hidden="true" tabindex="-1"></a>analysis_period <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-71"><a href="app-code.html#cb4-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="fu">min</span>(df<span class="sc">$</span>date), <span class="st">&quot; - &quot;</span>, <span class="fu">max</span>(df<span class="sc">$</span>date))</span>
<span id="cb4-72"><a href="app-code.html#cb4-72" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-73"><a href="app-code.html#cb4-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-74"><a href="app-code.html#cb4-74" aria-hidden="true" tabindex="-1"></a>split_name_email <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-75"><a href="app-code.html#cb4-75" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make two new variables (i.e., email; name) out of &quot;from&quot; variable:</span></span>
<span id="cb4-76"><a href="app-code.html#cb4-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># I need to revisit this condition later on to address a data which has gone through pseudo process already:</span></span>
<span id="cb4-77"><a href="app-code.html#cb4-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if(!(&quot;from&quot; %in% names(df))) {</span></span>
<span id="cb4-78"><a href="app-code.html#cb4-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if(&quot;pseudonym&quot; %in% names(df)) {</span></span>
<span id="cb4-79"><a href="app-code.html#cb4-79" aria-hidden="true" tabindex="-1"></a>    <span class="co">#</span></span>
<span id="cb4-80"><a href="app-code.html#cb4-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># } else {</span></span>
<span id="cb4-81"><a href="app-code.html#cb4-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># stop(&quot;You don&#39;t have unique identifier in the data.&quot;)</span></span>
<span id="cb4-82"><a href="app-code.html#cb4-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb4-83"><a href="app-code.html#cb4-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb4-84"><a href="app-code.html#cb4-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-85"><a href="app-code.html#cb4-85" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-86"><a href="app-code.html#cb4-86" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">from =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(from, <span class="st">&quot; at &quot;</span>, <span class="st">&quot;@&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-87"><a href="app-code.html#cb4-87" aria-hidden="true" tabindex="-1"></a>        tidyr<span class="sc">::</span><span class="fu">separate</span>(from, <span class="fu">c</span>(<span class="st">&quot;email&quot;</span>, <span class="st">&quot;name&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">s(?=</span><span class="sc">\\</span><span class="st">()&quot;</span>, <span class="at">extra =</span> <span class="st">&quot;merge&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-88"><a href="app-code.html#cb4-88" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">name =</span> stringr<span class="sc">::</span><span class="fu">str_trim</span>(stringr<span class="sc">::</span><span class="fu">str_sub</span>(name, <span class="at">start =</span> <span class="dv">2</span>, <span class="at">end =</span> <span class="sc">-</span><span class="dv">2</span>)))</span>
<span id="cb4-89"><a href="app-code.html#cb4-89" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-90"><a href="app-code.html#cb4-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-91"><a href="app-code.html#cb4-91" aria-hidden="true" tabindex="-1"></a>remove_prefix <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">pattern =</span> <span class="st">&quot;^</span><span class="sc">\\</span><span class="st">[nfbcs</span><span class="sc">\\</span><span class="st">] &quot;</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb4-92"><a href="app-code.html#cb4-92" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">is.null</span>(pattern)) <span class="fu">stop</span>(<span class="st">&quot;You must specify the pattern.&quot;</span>)</span>
<span id="cb4-93"><a href="app-code.html#cb4-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-94"><a href="app-code.html#cb4-94" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Text preprocessing</span></span>
<span id="cb4-95"><a href="app-code.html#cb4-95" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Remove unnecessary prefix([nfbcs]) from subject line</span></span>
<span id="cb4-96"><a href="app-code.html#cb4-96" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-97"><a href="app-code.html#cb4-97" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">subject =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="at">string =</span> subject, <span class="at">pattern =</span> stringr<span class="sc">::</span><span class="fu">regex</span>(pattern, <span class="at">ignore_case =</span> ignore_case), <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb4-98"><a href="app-code.html#cb4-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-99"><a href="app-code.html#cb4-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-100"><a href="app-code.html#cb4-100" aria-hidden="true" tabindex="-1"></a>collapse_date <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-101"><a href="app-code.html#cb4-101" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Making three variables (i.e., year, month, and day) out of date variable:</span></span>
<span id="cb4-102"><a href="app-code.html#cb4-102" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-103"><a href="app-code.html#cb4-103" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date), <span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>), <span class="at">day =</span> lubridate<span class="sc">::</span><span class="fu">day</span>(date))</span>
<span id="cb4-104"><a href="app-code.html#cb4-104" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-105"><a href="app-code.html#cb4-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-106"><a href="app-code.html#cb4-106" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding row number as an ID</span></span>
<span id="cb4-107"><a href="app-code.html#cb4-107" aria-hidden="true" tabindex="-1"></a><span class="co"># df %&gt;%</span></span>
<span id="cb4-108"><a href="app-code.html#cb4-108" aria-hidden="true" tabindex="-1"></a><span class="co"># tibble::rowid_to_column()</span></span>
<span id="cb4-109"><a href="app-code.html#cb4-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-110"><a href="app-code.html#cb4-110" aria-hidden="true" tabindex="-1"></a>count_emails <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-111"><a href="app-code.html#cb4-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Counting the number of participants using email as an unique ID:</span></span>
<span id="cb4-112"><a href="app-code.html#cb4-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>(<span class="st">&quot;email&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb4-113"><a href="app-code.html#cb4-113" aria-hidden="true" tabindex="-1"></a>        df <span class="ot">&lt;-</span> <span class="fu">split_name_email</span>(df)</span>
<span id="cb4-114"><a href="app-code.html#cb4-114" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-115"><a href="app-code.html#cb4-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-116"><a href="app-code.html#cb4-116" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-117"><a href="app-code.html#cb4-117" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">group_by</span>(email) <span class="sc">%&gt;%</span></span>
<span id="cb4-118"><a href="app-code.html#cb4-118" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(message_ID, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-119"><a href="app-code.html#cb4-119" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-120"><a href="app-code.html#cb4-120" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(email, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-121"><a href="app-code.html#cb4-121" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-122"><a href="app-code.html#cb4-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-123"><a href="app-code.html#cb4-123" aria-hidden="true" tabindex="-1"></a>num_participants <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-124"><a href="app-code.html#cb4-124" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-125"><a href="app-code.html#cb4-125" aria-hidden="true" tabindex="-1"></a>        <span class="fu">count_emails</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-126"><a href="app-code.html#cb4-126" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>()</span>
<span id="cb4-127"><a href="app-code.html#cb4-127" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-128"><a href="app-code.html#cb4-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-129"><a href="app-code.html#cb4-129" aria-hidden="true" tabindex="-1"></a>popular_subjects <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-130"><a href="app-code.html#cb4-130" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Most popular subject</span></span>
<span id="cb4-131"><a href="app-code.html#cb4-131" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-132"><a href="app-code.html#cb4-132" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(subject, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-133"><a href="app-code.html#cb4-133" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-134"><a href="app-code.html#cb4-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-135"><a href="app-code.html#cb4-135" aria-hidden="true" tabindex="-1"></a>top_participated_subjects <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">top_n =</span> <span class="dv">20</span>) {</span>
<span id="cb4-136"><a href="app-code.html#cb4-136" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Most actively discussed subject</span></span>
<span id="cb4-137"><a href="app-code.html#cb4-137" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-138"><a href="app-code.html#cb4-138" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(num_discussants)) <span class="sc">%&gt;%</span></span>
<span id="cb4-139"><a href="app-code.html#cb4-139" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">distinct</span>(subject, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-140"><a href="app-code.html#cb4-140" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(subject, num_discussants) <span class="sc">%&gt;%</span></span>
<span id="cb4-141"><a href="app-code.html#cb4-141" aria-hidden="true" tabindex="-1"></a>        <span class="fu">head</span>(top_n)</span>
<span id="cb4-142"><a href="app-code.html#cb4-142" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-143"><a href="app-code.html#cb4-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-144"><a href="app-code.html#cb4-144" aria-hidden="true" tabindex="-1"></a>top_active_participants <span class="ot">&lt;-</span> <span class="cf">function</span>(df, <span class="at">top_n =</span> <span class="dv">20</span>) {</span>
<span id="cb4-145"><a href="app-code.html#cb4-145" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the most active participant:</span></span>
<span id="cb4-146"><a href="app-code.html#cb4-146" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>(<span class="st">&quot;email&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb4-147"><a href="app-code.html#cb4-147" aria-hidden="true" tabindex="-1"></a>        df <span class="ot">&lt;-</span> <span class="fu">split_name_email</span>(df)</span>
<span id="cb4-148"><a href="app-code.html#cb4-148" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-149"><a href="app-code.html#cb4-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-150"><a href="app-code.html#cb4-150" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-151"><a href="app-code.html#cb4-151" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(email, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-152"><a href="app-code.html#cb4-152" aria-hidden="true" tabindex="-1"></a>        <span class="fu">head</span>(top_n) <span class="sc">%&gt;%</span></span>
<span id="cb4-153"><a href="app-code.html#cb4-153" aria-hidden="true" tabindex="-1"></a>        <span class="fu">viewxl</span>()</span>
<span id="cb4-154"><a href="app-code.html#cb4-154" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-155"><a href="app-code.html#cb4-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-156"><a href="app-code.html#cb4-156" aria-hidden="true" tabindex="-1"></a>average_individual_participation <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-157"><a href="app-code.html#cb4-157" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Average number of participation per each individual using email as an unique ID:</span></span>
<span id="cb4-158"><a href="app-code.html#cb4-158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>(<span class="st">&quot;email&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb4-159"><a href="app-code.html#cb4-159" aria-hidden="true" tabindex="-1"></a>        df <span class="ot">&lt;-</span> <span class="fu">split_name_email</span>(df)</span>
<span id="cb4-160"><a href="app-code.html#cb4-160" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-161"><a href="app-code.html#cb4-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-162"><a href="app-code.html#cb4-162" aria-hidden="true" tabindex="-1"></a>    num_message_per_individual <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb4-163"><a href="app-code.html#cb4-163" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(email)</span>
<span id="cb4-164"><a href="app-code.html#cb4-164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(num_message_per_individual<span class="sc">$</span>n)</span>
<span id="cb4-165"><a href="app-code.html#cb4-165" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-166"><a href="app-code.html#cb4-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-167"><a href="app-code.html#cb4-167" aria-hidden="true" tabindex="-1"></a>average_num_discussants <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-168"><a href="app-code.html#cb4-168" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Average number of discussants:</span></span>
<span id="cb4-169"><a href="app-code.html#cb4-169" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(df<span class="sc">$</span>num_discussants)</span>
<span id="cb4-170"><a href="app-code.html#cb4-170" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-171"><a href="app-code.html#cb4-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-172"><a href="app-code.html#cb4-172" aria-hidden="true" tabindex="-1"></a>remove_original_msg <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-173"><a href="app-code.html#cb4-173" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Text preprocessing</span></span>
<span id="cb4-174"><a href="app-code.html#cb4-174" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Remove unnecessary original message(s) from replied thread</span></span>
<span id="cb4-175"><a href="app-code.html#cb4-175" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-176"><a href="app-code.html#cb4-176" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">content =</span> <span class="fu">ifelse</span>(<span class="fu">is_thread</span>(df), stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="at">string =</span> content, <span class="at">pattern =</span> <span class="st">&quot;([_]+[[:cntrl:]]?[[:print:]]+nfbcs mailing list[[:cntrl:]]?[[:print:]]+nfbcs at nfbnet.org[[:print:][:cntrl:]]*)|(--[[:print:]]*Original Message</span><span class="sc">\\</span><span class="st">s?--[[:print:][:cntrl:]]*)|(On </span><span class="sc">\\</span><span class="st">d+/</span><span class="sc">\\</span><span class="st">d+/</span><span class="sc">\\</span><span class="st">d+[[:print:][:cntrl:]]+wrote:[[:cntrl:][:print:]]*)|(At </span><span class="sc">\\</span><span class="st">d+:</span><span class="sc">\\</span><span class="st">d+[</span><span class="sc">\\</span><span class="st">s[:cntrl:]]+[[:alpha:]]{2}[</span><span class="sc">\\</span><span class="st">s[:cntrl:]]+</span><span class="sc">\\</span><span class="st">d+/</span><span class="sc">\\</span><span class="st">d+/</span><span class="sc">\\</span><span class="st">d+,[[:print:][:cntrl:]]+wrote:[[:cntrl:][:print:]]*)|(On [[:alnum:]]+[[:print:][:cntrl:]]+via[[:print:][:cntrl:]]+wrote[[:cntrl:][:print:]]*)|(On [[:alnum:]]+[[:print:][:cntrl:]]+wrote:[[:cntrl:][:print:]]*)|(&gt; From: [[:print:][:cntrl:]]+&gt; To: nfb[[:print:][:cntrl:]]*)|([[:cntrl:]]+&gt;[[:cntrl:]]*)|(-----BEGIN PGP SIGNED MESSAGE-----[[:print:][:cntrl:]]*)|(nfbcs mailing list[[:cntrl:][:print:]]*nfbcs at nfbnet.org[[:print:][:cntrl:]]*)|(This message was sent from a mobile device[[:print:][:cntrl:]]*)|(</span><span class="sc">\\</span><span class="st">n-+[[:print:]]*</span><span class="sc">\\</span><span class="st">n*$)&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>), content))</span>
<span id="cb4-177"><a href="app-code.html#cb4-177" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-178"><a href="app-code.html#cb4-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-179"><a href="app-code.html#cb4-179" aria-hidden="true" tabindex="-1"></a>remove_quoted_msg <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-180"><a href="app-code.html#cb4-180" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-181"><a href="app-code.html#cb4-181" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">content =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="at">string =</span> content, <span class="at">pattern =</span> <span class="st">&quot;(</span><span class="sc">\\</span><span class="st">n&gt;[[:print:][:cntrl:]]*(?=</span><span class="sc">\\</span><span class="st">n&gt;)[[:cntrl:][:print:]]*)|(&gt;[[:print:][:cntrl:]]*&gt;[[:print:][:cntrl:]]*)|(No virus found in this incoming message.[[:print:][:cntrl:]]*)|(-+</span><span class="sc">\\</span><span class="st">s?next part</span><span class="sc">\\</span><span class="st">s?-+[[:print:][:cntrl:]]*)|(A non-text attachment was scrubbed...[[:print:][:cntrl:]]*)|(__________ Information from ESET NOD32 Antivirus[[:print:][:cntrl:]]*)|(-+</span><span class="sc">\\</span><span class="st">s?Original Message</span><span class="sc">\\</span><span class="st">s?-+[[:print:][:cntrl:]]*)|(An HTML attachment was scrubbed[[:cntrl:][:print:]]*)|(=+</span><span class="sc">\\</span><span class="st">nCopyright[[:cntrl:][:print:]]*)|(URL: &lt;http://nfbnet[.]org/pipermail[[:cntrl:][:print:]]*)|(([Ff]rom|[Tt]o): [[:print:][:cntrl:]]+[</span><span class="sc">\\</span><span class="st">n</span><span class="sc">\\</span><span class="st">t ]([Tt]o|[Ff]rom): [[:print:][:cntrl:]]+[</span><span class="sc">\\</span><span class="st">n</span><span class="sc">\\</span><span class="st">t ]([Ss]ubject|[Dd]ate): [[:print:][:cntrl:]]*)|(</span><span class="sc">\\</span><span class="st">n-+[[:print:]]*</span><span class="sc">\\</span><span class="st">n*$)&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb4-182"><a href="app-code.html#cb4-182" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-183"><a href="app-code.html#cb4-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-184"><a href="app-code.html#cb4-184" aria-hidden="true" tabindex="-1"></a>pseudonymize <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb4-185"><a href="app-code.html#cb4-185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sapply</span>(x, <span class="cf">function</span>(x) {</span>
<span id="cb4-186"><a href="app-code.html#cb4-186" aria-hidden="true" tabindex="-1"></a>        bcrypt<span class="sc">::</span><span class="fu">hashpw</span>(x, bcrypt<span class="sc">::</span><span class="fu">gensalt</span>(<span class="dv">11</span>))</span>
<span id="cb4-187"><a href="app-code.html#cb4-187" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb4-188"><a href="app-code.html#cb4-188" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-189"><a href="app-code.html#cb4-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-190"><a href="app-code.html#cb4-190" aria-hidden="true" tabindex="-1"></a>make_pseudonym_table <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-191"><a href="app-code.html#cb4-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>(<span class="st">&quot;email&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb4-192"><a href="app-code.html#cb4-192" aria-hidden="true" tabindex="-1"></a>        df <span class="ot">&lt;-</span> <span class="fu">split_name_email</span>(df)</span>
<span id="cb4-193"><a href="app-code.html#cb4-193" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-194"><a href="app-code.html#cb4-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-195"><a href="app-code.html#cb4-195" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-196"><a href="app-code.html#cb4-196" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">distinct</span>(email) <span class="sc">%&gt;%</span></span>
<span id="cb4-197"><a href="app-code.html#cb4-197" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">pseudonym =</span> <span class="fu">pseudonymize</span>(email))</span>
<span id="cb4-198"><a href="app-code.html#cb4-198" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-199"><a href="app-code.html#cb4-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-200"><a href="app-code.html#cb4-200" aria-hidden="true" tabindex="-1"></a>anonymization <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-201"><a href="app-code.html#cb4-201" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>(<span class="st">&quot;email&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb4-202"><a href="app-code.html#cb4-202" aria-hidden="true" tabindex="-1"></a>        df <span class="ot">&lt;-</span> <span class="fu">split_name_email</span>(df)</span>
<span id="cb4-203"><a href="app-code.html#cb4-203" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-204"><a href="app-code.html#cb4-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-205"><a href="app-code.html#cb4-205" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-206"><a href="app-code.html#cb4-206" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">inner_join</span>(<span class="fu">make_pseudonym_table</span>(df), <span class="at">by =</span> <span class="st">&quot;email&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-207"><a href="app-code.html#cb4-207" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name, <span class="sc">-</span>email)</span>
<span id="cb4-208"><a href="app-code.html#cb4-208" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-209"><a href="app-code.html#cb4-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-210"><a href="app-code.html#cb4-210" aria-hidden="true" tabindex="-1"></a>num_unreplied_topics <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-211"><a href="app-code.html#cb4-211" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb4-212"><a href="app-code.html#cb4-212" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unnest_references</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-213"><a href="app-code.html#cb4-213" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(references)) <span class="sc">%&gt;%</span></span>
<span id="cb4-214"><a href="app-code.html#cb4-214" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(references)</span>
<span id="cb4-215"><a href="app-code.html#cb4-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-216"><a href="app-code.html#cb4-216" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-217"><a href="app-code.html#cb4-217" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(num_discussants <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-218"><a href="app-code.html#cb4-218" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">anti_join</span>(tmp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;message_ID&quot;</span> <span class="ot">=</span> <span class="st">&quot;references&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-219"><a href="app-code.html#cb4-219" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(message_ID) <span class="sc">%&gt;%</span></span>
<span id="cb4-220"><a href="app-code.html#cb4-220" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>()</span>
<span id="cb4-221"><a href="app-code.html#cb4-221" aria-hidden="true" tabindex="-1"></a>    <span class="co"># total_msg_instances(df) - num_collaborative_msg(df)</span></span>
<span id="cb4-222"><a href="app-code.html#cb4-222" aria-hidden="true" tabindex="-1"></a>    <span class="co"># num_single_msg(df) - num_referenced_initial_msg(df)</span></span>
<span id="cb4-223"><a href="app-code.html#cb4-223" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-224"><a href="app-code.html#cb4-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-225"><a href="app-code.html#cb4-225" aria-hidden="true" tabindex="-1"></a>set_root_msg <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-226"><a href="app-code.html#cb4-226" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-227"><a href="app-code.html#cb4-227" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb4-228"><a href="app-code.html#cb4-228" aria-hidden="true" tabindex="-1"></a>            <span class="at">root_msg =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="at">string =</span> references, <span class="at">pattern =</span> <span class="st">&quot;(&gt;[[:cntrl:][:print:]]*&lt;[[:print:][:cntrl:]]*)|(&gt;&lt;[[:print:][:cntrl:]]*)&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&gt;&quot;</span>)</span>
<span id="cb4-229"><a href="app-code.html#cb4-229" aria-hidden="true" tabindex="-1"></a>            <span class="co"># , root_msg = ifelse(is.na(root_msg), message_ID, root_msg)</span></span>
<span id="cb4-230"><a href="app-code.html#cb4-230" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb4-231"><a href="app-code.html#cb4-231" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-232"><a href="app-code.html#cb4-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-233"><a href="app-code.html#cb4-233" aria-hidden="true" tabindex="-1"></a>count_replied_topics <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-234"><a href="app-code.html#cb4-234" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>(<span class="st">&quot;root_msg&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb4-235"><a href="app-code.html#cb4-235" aria-hidden="true" tabindex="-1"></a>        df <span class="ot">&lt;-</span> <span class="fu">set_root_msg</span>(df)</span>
<span id="cb4-236"><a href="app-code.html#cb4-236" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-237"><a href="app-code.html#cb4-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-238"><a href="app-code.html#cb4-238" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tmp &lt;- df %&gt;%</span></span>
<span id="cb4-239"><a href="app-code.html#cb4-239" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::select(message_ID, subject) %&gt;%</span></span>
<span id="cb4-240"><a href="app-code.html#cb4-240" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::rename(root_msg = message_ID)</span></span>
<span id="cb4-241"><a href="app-code.html#cb4-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-242"><a href="app-code.html#cb4-242" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-243"><a href="app-code.html#cb4-243" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(num_discussants <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-244"><a href="app-code.html#cb4-244" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">group_by</span>(message_ID) <span class="sc">%&gt;%</span></span>
<span id="cb4-245"><a href="app-code.html#cb4-245" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(root_msg) <span class="sc">%&gt;%</span></span>
<span id="cb4-246"><a href="app-code.html#cb4-246" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-247"><a href="app-code.html#cb4-247" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(root_msg, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-248"><a href="app-code.html#cb4-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-249"><a href="app-code.html#cb4-249" aria-hidden="true" tabindex="-1"></a>    <span class="co"># %&gt;%</span></span>
<span id="cb4-250"><a href="app-code.html#cb4-250" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::inner_join(tmp) %&gt;%</span></span>
<span id="cb4-251"><a href="app-code.html#cb4-251" aria-hidden="true" tabindex="-1"></a>    <span class="co"># dplyr::select(subject, n, root_msg)</span></span>
<span id="cb4-252"><a href="app-code.html#cb4-252" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-253"><a href="app-code.html#cb4-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-254"><a href="app-code.html#cb4-254" aria-hidden="true" tabindex="-1"></a>btw_n_persons_subjects <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-255"><a href="app-code.html#cb4-255" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span>(<span class="st">&quot;root_msg&quot;</span> <span class="sc">%in%</span> <span class="fu">names</span>(df))) {</span>
<span id="cb4-256"><a href="app-code.html#cb4-256" aria-hidden="true" tabindex="-1"></a>        df <span class="ot">&lt;-</span> <span class="fu">set_root_msg</span>(df)</span>
<span id="cb4-257"><a href="app-code.html#cb4-257" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-258"><a href="app-code.html#cb4-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-259"><a href="app-code.html#cb4-259" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(</span>
<span id="cb4-260"><a href="app-code.html#cb4-260" aria-hidden="true" tabindex="-1"></a>        df <span class="sc">%&gt;%</span></span>
<span id="cb4-261"><a href="app-code.html#cb4-261" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">count</span>(root_msg) <span class="sc">%&gt;%</span></span>
<span id="cb4-262"><a href="app-code.html#cb4-262" aria-hidden="true" tabindex="-1"></a>            dplyr<span class="sc">::</span><span class="fu">filter</span>(n <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb4-263"><a href="app-code.html#cb4-263" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-264"><a href="app-code.html#cb4-264" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-265"><a href="app-code.html#cb4-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-266"><a href="app-code.html#cb4-266" aria-hidden="true" tabindex="-1"></a>num_replied_topics <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-267"><a href="app-code.html#cb4-267" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(<span class="fu">count_replied_topics</span>(df))</span>
<span id="cb4-268"><a href="app-code.html#cb4-268" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-269"><a href="app-code.html#cb4-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-270"><a href="app-code.html#cb4-270" aria-hidden="true" tabindex="-1"></a>num_replying_msg <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-271"><a href="app-code.html#cb4-271" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count_replied_topics</span>(df) <span class="sc">%&gt;%</span></span>
<span id="cb4-272"><a href="app-code.html#cb4-272" aria-hidden="true" tabindex="-1"></a>        <span class="fu">select</span>(n) <span class="sc">%&gt;%</span></span>
<span id="cb4-273"><a href="app-code.html#cb4-273" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sum</span>()</span>
<span id="cb4-274"><a href="app-code.html#cb4-274" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-275"><a href="app-code.html#cb4-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-276"><a href="app-code.html#cb4-276" aria-hidden="true" tabindex="-1"></a>num_collaborative_msg <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-277"><a href="app-code.html#cb4-277" aria-hidden="true" tabindex="-1"></a>    <span class="fu">num_replying_msg</span>(df) <span class="sc">+</span> <span class="fu">num_referenced_initial_msg</span>(df)</span>
<span id="cb4-278"><a href="app-code.html#cb4-278" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-279"><a href="app-code.html#cb4-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-280"><a href="app-code.html#cb4-280" aria-hidden="true" tabindex="-1"></a>total_topics <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-281"><a href="app-code.html#cb4-281" aria-hidden="true" tabindex="-1"></a>    <span class="fu">num_replied_topics</span>(df) <span class="sc">+</span> <span class="fu">num_unreplied_topics</span>(df)</span>
<span id="cb4-282"><a href="app-code.html#cb4-282" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-283"><a href="app-code.html#cb4-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-284"><a href="app-code.html#cb4-284" aria-hidden="true" tabindex="-1"></a>total_msg_instances <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-285"><a href="app-code.html#cb4-285" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-286"><a href="app-code.html#cb4-286" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(message_ID) <span class="sc">%&gt;%</span></span>
<span id="cb4-287"><a href="app-code.html#cb4-287" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>()</span>
<span id="cb4-288"><a href="app-code.html#cb4-288" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-289"><a href="app-code.html#cb4-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-290"><a href="app-code.html#cb4-290" aria-hidden="true" tabindex="-1"></a>num_single_msg <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-291"><a href="app-code.html#cb4-291" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-292"><a href="app-code.html#cb4-292" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(num_discussants <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-293"><a href="app-code.html#cb4-293" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(message_ID) <span class="sc">%&gt;%</span></span>
<span id="cb4-294"><a href="app-code.html#cb4-294" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>()</span>
<span id="cb4-295"><a href="app-code.html#cb4-295" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-296"><a href="app-code.html#cb4-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-297"><a href="app-code.html#cb4-297" aria-hidden="true" tabindex="-1"></a>num_referenced_initial_msg <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-298"><a href="app-code.html#cb4-298" aria-hidden="true" tabindex="-1"></a>    <span class="fu">num_single_msg</span>(df) <span class="sc">-</span> <span class="fu">num_unreplied_topics</span>(df)</span>
<span id="cb4-299"><a href="app-code.html#cb4-299" aria-hidden="true" tabindex="-1"></a>    <span class="co"># num_replied_topics(df)</span></span>
<span id="cb4-300"><a href="app-code.html#cb4-300" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-301"><a href="app-code.html#cb4-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-302"><a href="app-code.html#cb4-302" aria-hidden="true" tabindex="-1"></a>unreplied_rate <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-303"><a href="app-code.html#cb4-303" aria-hidden="true" tabindex="-1"></a>    <span class="fu">num_unreplied_topics</span>(df) <span class="sc">/</span> <span class="fu">num_single_msg</span>(df)</span>
<span id="cb4-304"><a href="app-code.html#cb4-304" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-305"><a href="app-code.html#cb4-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-306"><a href="app-code.html#cb4-306" aria-hidden="true" tabindex="-1"></a>replied_rate <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-307"><a href="app-code.html#cb4-307" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span> <span class="sc">-</span> <span class="fu">unreplied_rate</span>(df)</span>
<span id="cb4-308"><a href="app-code.html#cb4-308" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-309"><a href="app-code.html#cb4-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-310"><a href="app-code.html#cb4-310" aria-hidden="true" tabindex="-1"></a>discussion_start_ratio <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-311"><a href="app-code.html#cb4-311" aria-hidden="true" tabindex="-1"></a>    <span class="fu">num_referenced_initial_msg</span>(df) <span class="sc">/</span> <span class="fu">num_collaborative_msg</span>(df)</span>
<span id="cb4-312"><a href="app-code.html#cb4-312" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-313"><a href="app-code.html#cb4-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-314"><a href="app-code.html#cb4-314" aria-hidden="true" tabindex="-1"></a>summary_msg <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-315"><a href="app-code.html#cb4-315" aria-hidden="true" tabindex="-1"></a>    df2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb4-316"><a href="app-code.html#cb4-316" aria-hidden="true" tabindex="-1"></a>        <span class="fu">remove_num_msg_to_undefined_references</span>()</span>
<span id="cb4-317"><a href="app-code.html#cb4-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-318"><a href="app-code.html#cb4-318" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb4-319"><a href="app-code.html#cb4-319" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Analysis period</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">analysis_period</span>(df),</span>
<span id="cb4-320"><a href="app-code.html#cb4-320" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Total active participants</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">num_participants</span>(df),</span>
<span id="cb4-321"><a href="app-code.html#cb4-321" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Total msg instances</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">total_msg_instances</span>(df),</span>
<span id="cb4-322"><a href="app-code.html#cb4-322" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Number of msg to undefined references</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">num_msg_to_undefined_references</span>(df),</span>
<span id="cb4-323"><a href="app-code.html#cb4-323" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Number of identifiable msg</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">num_identifiable_msg</span>(df),</span>
<span id="cb4-324"><a href="app-code.html#cb4-324" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Number of thread</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">num_thread</span>(df2),</span>
<span id="cb4-325"><a href="app-code.html#cb4-325" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Number of single msg</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">num_single_msg</span>(df2),</span>
<span id="cb4-326"><a href="app-code.html#cb4-326" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Number of collaborative msg</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">num_collaborative_msg</span>(df2),</span>
<span id="cb4-327"><a href="app-code.html#cb4-327" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Number of referenced initial msg</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">num_referenced_initial_msg</span>(df2),</span>
<span id="cb4-328"><a href="app-code.html#cb4-328" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Number of response msg</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">num_replying_msg</span>(df2),</span>
<span id="cb4-329"><a href="app-code.html#cb4-329" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Total topics</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">total_topics</span>(df2),</span>
<span id="cb4-330"><a href="app-code.html#cb4-330" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Total replied topics</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">num_replied_topics</span>(df2),</span>
<span id="cb4-331"><a href="app-code.html#cb4-331" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Total unreplied topics</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">num_unreplied_topics</span>(df2),</span>
<span id="cb4-332"><a href="app-code.html#cb4-332" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Unreplied rate</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">unreplied_rate</span>(df2),</span>
<span id="cb4-333"><a href="app-code.html#cb4-333" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Replied rate</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">replied_rate</span>(df2),</span>
<span id="cb4-334"><a href="app-code.html#cb4-334" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Discussion start msg ratio to a total collaborative msg</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">discussion_start_ratio</span>(df2)</span>
<span id="cb4-335"><a href="app-code.html#cb4-335" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-336"><a href="app-code.html#cb4-336" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-337"><a href="app-code.html#cb4-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-338"><a href="app-code.html#cb4-338" aria-hidden="true" tabindex="-1"></a>unnest_references <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-339"><a href="app-code.html#cb4-339" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-340"><a href="app-code.html#cb4-340" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">references =</span> stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="at">string =</span> references, <span class="at">pattern =</span> <span class="st">&quot;(&gt;[[:cntrl:][:print:]]*&lt;)|(&gt;&lt;)&quot;</span>, <span class="at">replacement =</span> <span class="st">&quot;&gt;@@&lt;&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-341"><a href="app-code.html#cb4-341" aria-hidden="true" tabindex="-1"></a>        tidytext<span class="sc">::</span><span class="fu">unnest_tokens</span>(references, references, <span class="at">token =</span> stringr<span class="sc">::</span>str_split, <span class="at">pattern =</span> <span class="st">&quot;@@&quot;</span>, <span class="at">to_lower =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-342"><a href="app-code.html#cb4-342" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-343"><a href="app-code.html#cb4-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-344"><a href="app-code.html#cb4-344" aria-hidden="true" tabindex="-1"></a>num_past_topics <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-345"><a href="app-code.html#cb4-345" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-346"><a href="app-code.html#cb4-346" aria-hidden="true" tabindex="-1"></a>        <span class="fu">past_msg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-347"><a href="app-code.html#cb4-347" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(references, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-348"><a href="app-code.html#cb4-348" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>()</span>
<span id="cb4-349"><a href="app-code.html#cb4-349" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-350"><a href="app-code.html#cb4-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-351"><a href="app-code.html#cb4-351" aria-hidden="true" tabindex="-1"></a>num_past_msg <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-352"><a href="app-code.html#cb4-352" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-353"><a href="app-code.html#cb4-353" aria-hidden="true" tabindex="-1"></a>        <span class="fu">past_msg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-354"><a href="app-code.html#cb4-354" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-355"><a href="app-code.html#cb4-355" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>()</span>
<span id="cb4-356"><a href="app-code.html#cb4-356" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-357"><a href="app-code.html#cb4-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-358"><a href="app-code.html#cb4-358" aria-hidden="true" tabindex="-1"></a>past_msg <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-359"><a href="app-code.html#cb4-359" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb4-360"><a href="app-code.html#cb4-360" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">distinct</span>(message_ID) <span class="sc">%&gt;%</span></span>
<span id="cb4-361"><a href="app-code.html#cb4-361" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(message_ID)</span>
<span id="cb4-362"><a href="app-code.html#cb4-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-363"><a href="app-code.html#cb4-363" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-364"><a href="app-code.html#cb4-364" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unnest_references</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-365"><a href="app-code.html#cb4-365" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(references)) <span class="sc">%&gt;%</span></span>
<span id="cb4-366"><a href="app-code.html#cb4-366" aria-hidden="true" tabindex="-1"></a>        <span class="fu">anti_join</span>(tmp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;references&quot;</span> <span class="ot">=</span> <span class="st">&quot;message_ID&quot;</span>))</span>
<span id="cb4-367"><a href="app-code.html#cb4-367" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-368"><a href="app-code.html#cb4-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-369"><a href="app-code.html#cb4-369" aria-hidden="true" tabindex="-1"></a><span class="co"># I think this is the real number of the msgs referencing the past topics</span></span>
<span id="cb4-370"><a href="app-code.html#cb4-370" aria-hidden="true" tabindex="-1"></a>summary_past_topics <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-371"><a href="app-code.html#cb4-371" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb4-372"><a href="app-code.html#cb4-372" aria-hidden="true" tabindex="-1"></a>        <span class="fu">past_msg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-373"><a href="app-code.html#cb4-373" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(references, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-374"><a href="app-code.html#cb4-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-375"><a href="app-code.html#cb4-375" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-376"><a href="app-code.html#cb4-376" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(message_ID, subject, date, references) <span class="sc">%&gt;%</span></span>
<span id="cb4-377"><a href="app-code.html#cb4-377" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">inner_join</span>(tmp) <span class="sc">%&gt;%</span></span>
<span id="cb4-378"><a href="app-code.html#cb4-378" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>()</span>
<span id="cb4-379"><a href="app-code.html#cb4-379" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-380"><a href="app-code.html#cb4-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-381"><a href="app-code.html#cb4-381" aria-hidden="true" tabindex="-1"></a>count_references <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-382"><a href="app-code.html#cb4-382" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-383"><a href="app-code.html#cb4-383" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unnest_references</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-384"><a href="app-code.html#cb4-384" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(references)) <span class="sc">%&gt;%</span></span>
<span id="cb4-385"><a href="app-code.html#cb4-385" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(references, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-386"><a href="app-code.html#cb4-386" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-387"><a href="app-code.html#cb4-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-388"><a href="app-code.html#cb4-388" aria-hidden="true" tabindex="-1"></a>count_msg <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-389"><a href="app-code.html#cb4-389" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-390"><a href="app-code.html#cb4-390" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(message_ID, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-391"><a href="app-code.html#cb4-391" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-392"><a href="app-code.html#cb4-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-393"><a href="app-code.html#cb4-393" aria-hidden="true" tabindex="-1"></a>count_undefined_references <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-394"><a href="app-code.html#cb4-394" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb4-395"><a href="app-code.html#cb4-395" aria-hidden="true" tabindex="-1"></a>        <span class="fu">count_msg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-396"><a href="app-code.html#cb4-396" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>n)</span>
<span id="cb4-397"><a href="app-code.html#cb4-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-398"><a href="app-code.html#cb4-398" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-399"><a href="app-code.html#cb4-399" aria-hidden="true" tabindex="-1"></a>        <span class="fu">count_references</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-400"><a href="app-code.html#cb4-400" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">anti_join</span>(tmp, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;references&quot;</span> <span class="ot">=</span> <span class="st">&quot;message_ID&quot;</span>))</span>
<span id="cb4-401"><a href="app-code.html#cb4-401" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-402"><a href="app-code.html#cb4-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-403"><a href="app-code.html#cb4-403" aria-hidden="true" tabindex="-1"></a>num_undefined_topics <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-404"><a href="app-code.html#cb4-404" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-405"><a href="app-code.html#cb4-405" aria-hidden="true" tabindex="-1"></a>        <span class="fu">count_undefined_references</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-406"><a href="app-code.html#cb4-406" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>()</span>
<span id="cb4-407"><a href="app-code.html#cb4-407" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-408"><a href="app-code.html#cb4-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-409"><a href="app-code.html#cb4-409" aria-hidden="true" tabindex="-1"></a>msg_to_undefined_references <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-410"><a href="app-code.html#cb4-410" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb4-411"><a href="app-code.html#cb4-411" aria-hidden="true" tabindex="-1"></a>        <span class="fu">count_undefined_references</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-412"><a href="app-code.html#cb4-412" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>n)</span>
<span id="cb4-413"><a href="app-code.html#cb4-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-414"><a href="app-code.html#cb4-414" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-415"><a href="app-code.html#cb4-415" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unnest_references</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-416"><a href="app-code.html#cb4-416" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(message_ID, references) <span class="sc">%&gt;%</span></span>
<span id="cb4-417"><a href="app-code.html#cb4-417" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">inner_join</span>(tmp, <span class="at">by =</span> <span class="st">&quot;references&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-418"><a href="app-code.html#cb4-418" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">count</span>(message_ID, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-419"><a href="app-code.html#cb4-419" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>n)</span>
<span id="cb4-420"><a href="app-code.html#cb4-420" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-421"><a href="app-code.html#cb4-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-422"><a href="app-code.html#cb4-422" aria-hidden="true" tabindex="-1"></a>num_msg_to_undefined_references <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-423"><a href="app-code.html#cb4-423" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-424"><a href="app-code.html#cb4-424" aria-hidden="true" tabindex="-1"></a>        <span class="fu">msg_to_undefined_references</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-425"><a href="app-code.html#cb4-425" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>()</span>
<span id="cb4-426"><a href="app-code.html#cb4-426" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-427"><a href="app-code.html#cb4-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-428"><a href="app-code.html#cb4-428" aria-hidden="true" tabindex="-1"></a>remove_num_msg_to_undefined_references <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-429"><a href="app-code.html#cb4-429" aria-hidden="true" tabindex="-1"></a>    df <span class="sc">%&gt;%</span></span>
<span id="cb4-430"><a href="app-code.html#cb4-430" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">anti_join</span>(<span class="fu">msg_to_undefined_references</span>(df), <span class="at">by =</span> <span class="st">&quot;message_ID&quot;</span>)</span>
<span id="cb4-431"><a href="app-code.html#cb4-431" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-432"><a href="app-code.html#cb4-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-433"><a href="app-code.html#cb4-433" aria-hidden="true" tabindex="-1"></a>num_identifiable_msg <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-434"><a href="app-code.html#cb4-434" aria-hidden="true" tabindex="-1"></a>    <span class="fu">total_msg_instances</span>(df) <span class="sc">-</span> <span class="fu">num_msg_to_undefined_references</span>(df)</span>
<span id="cb4-435"><a href="app-code.html#cb4-435" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="app-code.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quan RQ1.1: What are the frequency and variation patterns of collective knowledge participations of members in the target mailing listservs between January 2009 and December 2019?</span></span>
<span id="cb5-2"><a href="app-code.html#cb5-2" aria-hidden="true" tabindex="-1"></a>df_descriptive_summary <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="app-code.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_nest</span>(list) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="app-code.html#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">summary =</span> <span class="fu">map</span>(data, <span class="sc">~</span> <span class="fu">summary_msg</span>(.x))) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="app-code.html#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(list, summary) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="app-code.html#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(summary))</span>
<span id="cb5-7"><a href="app-code.html#cb5-7" aria-hidden="true" tabindex="-1"></a>df_descriptive_summary <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="app-code.html#cb5-8" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">&quot;Descriptive summary of each of the four NFB mailing lists.&quot;</span>, <span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>)</span>
<span id="cb5-9"><a href="app-code.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># We have imported our dataset and added a new group column &quot;list&quot;</span></span>
<span id="cb5-10"><a href="app-code.html#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Also dropped out two unnecessary empty columns (i.e., &quot;to&quot; and &quot;cc&quot;</span></span>
<span id="cb5-11"><a href="app-code.html#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Take a glimpse of our data:</span></span>
<span id="cb5-12"><a href="app-code.html#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span>
<span id="cb5-13"><a href="app-code.html#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="app-code.html#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of messages by list and sort in decreasing order:</span></span>
<span id="cb5-15"><a href="app-code.html#cb5-15" aria-hidden="true" tabindex="-1"></a>df_msg_per_list <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb5-16"><a href="app-code.html#cb5-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(list, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-17"><a href="app-code.html#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="app-code.html#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar chart:</span></span>
<span id="cb5-19"><a href="app-code.html#cb5-19" aria-hidden="true" tabindex="-1"></a>g_msg_per_list <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_msg_per_list, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(list, <span class="sc">-</span>n), <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb5-20"><a href="app-code.html#cb5-20" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> list), <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb5-21"><a href="app-code.html#cb5-21" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mailing lists&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Total number of messages&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-22"><a href="app-code.html#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Use the following code to make our chart accessible for those with color-blindness:</span></span>
<span id="cb5-23"><a href="app-code.html#cb5-23" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_d</span>()</span>
<span id="cb5-24"><a href="app-code.html#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Create alternative text for graph:</span></span>
<span id="cb5-25"><a href="app-code.html#cb5-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BrailleR)</span>
<span id="cb5-26"><a href="app-code.html#cb5-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-27"><a href="app-code.html#cb5-27" aria-hidden="true" tabindex="-1"></a>alt <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">capture.output</span>(BrailleR<span class="sc">::</span><span class="fu">VI</span>(g_msg_per_list)), <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb5-28"><a href="app-code.html#cb5-28" aria-hidden="true" tabindex="-1"></a>g_msg_per_list</span>
<span id="cb5-29"><a href="app-code.html#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Use &quot;email&quot; as unique identifier per member to count their  message frequency</span></span>
<span id="cb5-30"><a href="app-code.html#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Split name and email out of &quot;from&quot; column (because sometimes, &quot;from&quot; contains different pairs for the same individual):</span></span>
<span id="cb5-31"><a href="app-code.html#cb5-31" aria-hidden="true" tabindex="-1"></a>df_list_member_msg <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb5-32"><a href="app-code.html#cb5-32" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">from =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(from, <span class="st">&quot; at &quot;</span>, <span class="st">&quot;@&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-33"><a href="app-code.html#cb5-33" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(from, <span class="fu">c</span>(<span class="st">&quot;email&quot;</span>, <span class="st">&quot;name&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">s(?=</span><span class="sc">\\</span><span class="st">()&quot;</span>, <span class="at">extra =</span> <span class="st">&quot;merge&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-34"><a href="app-code.html#cb5-34" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">name =</span> stringr<span class="sc">::</span><span class="fu">str_trim</span>(stringr<span class="sc">::</span><span class="fu">str_sub</span>(name, <span class="at">start =</span> <span class="dv">2</span>, <span class="at">end =</span> <span class="sc">-</span><span class="dv">2</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb5-35"><a href="app-code.html#cb5-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(list, email)</span>
<span id="cb5-36"><a href="app-code.html#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="app-code.html#cb5-37" aria-hidden="true" tabindex="-1"></a>g_list_member_msg <span class="ot">&lt;-</span> df_list_member_msg <span class="sc">%&gt;%</span></span>
<span id="cb5-38"><a href="app-code.html#cb5-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> list, <span class="at">y =</span> n, <span class="at">fill =</span> list)) <span class="sc">+</span></span>
<span id="cb5-39"><a href="app-code.html#cb5-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">outlier.alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb5-40"><a href="app-code.html#cb5-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Mailing List&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of Messages Sent by a Member&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-41"><a href="app-code.html#cb5-41" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_d</span>()</span>
<span id="cb5-42"><a href="app-code.html#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="app-code.html#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Create alternative text for graph:</span></span>
<span id="cb5-44"><a href="app-code.html#cb5-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BrailleR)</span>
<span id="cb5-45"><a href="app-code.html#cb5-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-46"><a href="app-code.html#cb5-46" aria-hidden="true" tabindex="-1"></a>alt <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">capture.output</span>(BrailleR<span class="sc">::</span><span class="fu">VI</span>(g_list_member_msg)), <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb5-47"><a href="app-code.html#cb5-47" aria-hidden="true" tabindex="-1"></a>g_list_member_msg</span>
<span id="cb5-48"><a href="app-code.html#cb5-48" aria-hidden="true" tabindex="-1"></a>df_list_year_n <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb5-49"><a href="app-code.html#cb5-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(list, <span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date), <span class="at">sort =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-50"><a href="app-code.html#cb5-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(year)</span>
<span id="cb5-51"><a href="app-code.html#cb5-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-52"><a href="app-code.html#cb5-52" aria-hidden="true" tabindex="-1"></a>g_list_year_n <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> df_list_year_n, <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> n, <span class="at">color =</span> list, <span class="at">group =</span> list)) <span class="sc">+</span></span>
<span id="cb5-53"><a href="app-code.html#cb5-53" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb5-54"><a href="app-code.html#cb5-54" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Mailing list&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-55"><a href="app-code.html#cb5-55" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_viridis_d</span>()</span>
<span id="cb5-56"><a href="app-code.html#cb5-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-57"><a href="app-code.html#cb5-57" aria-hidden="true" tabindex="-1"></a>alt <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">capture.output</span>(BrailleR<span class="sc">::</span><span class="fu">VI</span>(g_list_year_n)), <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb5-58"><a href="app-code.html#cb5-58" aria-hidden="true" tabindex="-1"></a>g_list_year_n</span>
<span id="cb5-59"><a href="app-code.html#cb5-59" aria-hidden="true" tabindex="-1"></a><span class="co"># The top-10 most popular subjects per list</span></span>
<span id="cb5-60"><a href="app-code.html#cb5-60" aria-hidden="true" tabindex="-1"></a>top_10_subject <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb5-61"><a href="app-code.html#cb5-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(subject, <span class="st">&quot;Digest,&quot;</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb5-62"><a href="app-code.html#cb5-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(list) <span class="sc">%&gt;%</span></span>
<span id="cb5-63"><a href="app-code.html#cb5-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(subject, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-64"><a href="app-code.html#cb5-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-65"><a href="app-code.html#cb5-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb5-66"><a href="app-code.html#cb5-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-67"><a href="app-code.html#cb5-67" aria-hidden="true" tabindex="-1"></a>top_10_subject <span class="sc">%&gt;%</span></span>
<span id="cb5-68"><a href="app-code.html#cb5-68" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">&quot;The top-10 most participated topics within the four NFB mailing lists.&quot;</span>, <span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>)</span>
<span id="cb5-69"><a href="app-code.html#cb5-69" aria-hidden="true" tabindex="-1"></a><span class="co"># gt::gt()</span></span>
<span id="cb5-70"><a href="app-code.html#cb5-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Term-Frequency Inverse Document-Frequency (tf-idf)</span></span>
<span id="cb5-71"><a href="app-code.html#cb5-71" aria-hidden="true" tabindex="-1"></a>frequency <span class="ot">&lt;-</span> df_bow <span class="sc">%&gt;%</span></span>
<span id="cb5-72"><a href="app-code.html#cb5-72" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Count word frequency per list</span></span>
<span id="cb5-73"><a href="app-code.html#cb5-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(list, word) <span class="sc">%&gt;%</span></span>
<span id="cb5-74"><a href="app-code.html#cb5-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter word&#39;s frequency is greater than 1</span></span>
<span id="cb5-75"><a href="app-code.html#cb5-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_count</span>(word) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-76"><a href="app-code.html#cb5-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate tf-idf and arrange it in descending order</span></span>
<span id="cb5-77"><a href="app-code.html#cb5-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_tf_idf</span>(</span>
<span id="cb5-78"><a href="app-code.html#cb5-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> word,</span>
<span id="cb5-79"><a href="app-code.html#cb5-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">document =</span> list,</span>
<span id="cb5-80"><a href="app-code.html#cb5-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> n</span>
<span id="cb5-81"><a href="app-code.html#cb5-81" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-82"><a href="app-code.html#cb5-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>tf_idf)</span>
<span id="cb5-83"><a href="app-code.html#cb5-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-84"><a href="app-code.html#cb5-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Only include the top-10 tf-idf per list</span></span>
<span id="cb5-85"><a href="app-code.html#cb5-85" aria-hidden="true" tabindex="-1"></a>top10 <span class="ot">&lt;-</span> frequency <span class="sc">%&gt;%</span></span>
<span id="cb5-86"><a href="app-code.html#cb5-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(tf_idf) <span class="sc">%&gt;%</span></span>
<span id="cb5-87"><a href="app-code.html#cb5-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(list) <span class="sc">%&gt;%</span></span>
<span id="cb5-88"><a href="app-code.html#cb5-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(tf_idf, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-89"><a href="app-code.html#cb5-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-90"><a href="app-code.html#cb5-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform `list` into factor object for future plotting</span></span>
<span id="cb5-91"><a href="app-code.html#cb5-91" aria-hidden="true" tabindex="-1"></a>top10<span class="sc">$</span>list <span class="ot">&lt;-</span> <span class="fu">factor</span>(top10<span class="sc">$</span>list,</span>
<span id="cb5-92"><a href="app-code.html#cb5-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;cs&quot;</span>, <span class="st">&quot;math&quot;</span>, <span class="st">&quot;science&quot;</span>, <span class="st">&quot;arts&quot;</span>)</span>
<span id="cb5-93"><a href="app-code.html#cb5-93" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-94"><a href="app-code.html#cb5-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting top-10 tf-idf per list</span></span>
<span id="cb5-95"><a href="app-code.html#cb5-95" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(top10, <span class="fu">aes</span>(</span>
<span id="cb5-96"><a href="app-code.html#cb5-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">reorder_within</span>(word, tf_idf, list),</span>
<span id="cb5-97"><a href="app-code.html#cb5-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> tf_idf,</span>
<span id="cb5-98"><a href="app-code.html#cb5-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> list</span>
<span id="cb5-99"><a href="app-code.html#cb5-99" aria-hidden="true" tabindex="-1"></a>)) <span class="sc">+</span></span>
<span id="cb5-100"><a href="app-code.html#cb5-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb5-101"><a href="app-code.html#cb5-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb5-102"><a href="app-code.html#cb5-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>list, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb5-103"><a href="app-code.html#cb5-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reordered</span>() <span class="sc">+</span></span>
<span id="cb5-104"><a href="app-code.html#cb5-104" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb5-105"><a href="app-code.html#cb5-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span>))</span>
<span id="cb5-106"><a href="app-code.html#cb5-106" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-107"><a href="app-code.html#cb5-107" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(all_graph_pair, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-108"><a href="app-code.html#cb5-108" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-109"><a href="app-code.html#cb5-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-110"><a href="app-code.html#cb5-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb5-111"><a href="app-code.html#cb5-111" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-112"><a href="app-code.html#cb5-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-113"><a href="app-code.html#cb5-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-114"><a href="app-code.html#cb5-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-115"><a href="app-code.html#cb5-115" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-116"><a href="app-code.html#cb5-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-117"><a href="app-code.html#cb5-117" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-118"><a href="app-code.html#cb5-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb5-119"><a href="app-code.html#cb5-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-120"><a href="app-code.html#cb5-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-121"><a href="app-code.html#cb5-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-122"><a href="app-code.html#cb5-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-123"><a href="app-code.html#cb5-123" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-124"><a href="app-code.html#cb5-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-125"><a href="app-code.html#cb5-125" aria-hidden="true" tabindex="-1"></a>list_pair_count <span class="ot">&lt;-</span> df_bow <span class="sc">%&gt;%</span></span>
<span id="cb5-126"><a href="app-code.html#cb5-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(list) <span class="sc">%&gt;%</span></span>
<span id="cb5-127"><a href="app-code.html#cb5-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_modify</span>(</span>
<span id="cb5-128"><a href="app-code.html#cb5-128" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> widyr<span class="sc">::</span><span class="fu">pairwise_count</span>(</span>
<span id="cb5-129"><a href="app-code.html#cb5-129" aria-hidden="true" tabindex="-1"></a>      .x,</span>
<span id="cb5-130"><a href="app-code.html#cb5-130" aria-hidden="true" tabindex="-1"></a>      <span class="at">item =</span> word,</span>
<span id="cb5-131"><a href="app-code.html#cb5-131" aria-hidden="true" tabindex="-1"></a>      <span class="at">feature =</span> document,</span>
<span id="cb5-132"><a href="app-code.html#cb5-132" aria-hidden="true" tabindex="-1"></a>      <span class="at">sort =</span> <span class="cn">TRUE</span></span>
<span id="cb5-133"><a href="app-code.html#cb5-133" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-134"><a href="app-code.html#cb5-134" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-135"><a href="app-code.html#cb5-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb5-136"><a href="app-code.html#cb5-136" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-137"><a href="app-code.html#cb5-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-138"><a href="app-code.html#cb5-138" aria-hidden="true" tabindex="-1"></a>cs_pair_count <span class="ot">&lt;-</span> list_pair_count <span class="sc">%&gt;%</span></span>
<span id="cb5-139"><a href="app-code.html#cb5-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list <span class="sc">==</span> <span class="st">&quot;cs&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-140"><a href="app-code.html#cb5-140" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(n &gt;= 25) %&gt;%</span></span>
<span id="cb5-141"><a href="app-code.html#cb5-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-142"><a href="app-code.html#cb5-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-143"><a href="app-code.html#cb5-143" aria-hidden="true" tabindex="-1"></a>cs_graph_pair <span class="ot">&lt;-</span> cs_pair_count <span class="sc">%&gt;%</span></span>
<span id="cb5-144"><a href="app-code.html#cb5-144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-145"><a href="app-code.html#cb5-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-146"><a href="app-code.html#cb5-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>(), <span class="co"># Centrality</span></span>
<span id="cb5-147"><a href="app-code.html#cb5-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="fu">group_infomap</span>())</span>
<span id="cb5-148"><a href="app-code.html#cb5-148" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># Community</span></span>
<span id="cb5-149"><a href="app-code.html#cb5-149" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-150"><a href="app-code.html#cb5-150" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(cs_graph_pair, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-151"><a href="app-code.html#cb5-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-152"><a href="app-code.html#cb5-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-153"><a href="app-code.html#cb5-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb5-154"><a href="app-code.html#cb5-154" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-155"><a href="app-code.html#cb5-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-156"><a href="app-code.html#cb5-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-157"><a href="app-code.html#cb5-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-158"><a href="app-code.html#cb5-158" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-159"><a href="app-code.html#cb5-159" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-160"><a href="app-code.html#cb5-160" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-161"><a href="app-code.html#cb5-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb5-162"><a href="app-code.html#cb5-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-163"><a href="app-code.html#cb5-163" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-164"><a href="app-code.html#cb5-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-165"><a href="app-code.html#cb5-165" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-166"><a href="app-code.html#cb5-166" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-167"><a href="app-code.html#cb5-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-168"><a href="app-code.html#cb5-168" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-169"><a href="app-code.html#cb5-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-170"><a href="app-code.html#cb5-170" aria-hidden="true" tabindex="-1"></a>math_pair_count <span class="ot">&lt;-</span> list_pair_count <span class="sc">%&gt;%</span></span>
<span id="cb5-171"><a href="app-code.html#cb5-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list <span class="sc">==</span> <span class="st">&quot;math&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-172"><a href="app-code.html#cb5-172" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(n &gt;= 25) %&gt;%</span></span>
<span id="cb5-173"><a href="app-code.html#cb5-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-174"><a href="app-code.html#cb5-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-175"><a href="app-code.html#cb5-175" aria-hidden="true" tabindex="-1"></a>math_graph_pair <span class="ot">&lt;-</span> math_pair_count <span class="sc">%&gt;%</span></span>
<span id="cb5-176"><a href="app-code.html#cb5-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-177"><a href="app-code.html#cb5-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-178"><a href="app-code.html#cb5-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>(), <span class="co"># Centrality</span></span>
<span id="cb5-179"><a href="app-code.html#cb5-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="fu">group_infomap</span>())</span>
<span id="cb5-180"><a href="app-code.html#cb5-180" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># Community</span></span>
<span id="cb5-181"><a href="app-code.html#cb5-181" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-182"><a href="app-code.html#cb5-182" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(math_graph_pair, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-183"><a href="app-code.html#cb5-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-184"><a href="app-code.html#cb5-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-185"><a href="app-code.html#cb5-185" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb5-186"><a href="app-code.html#cb5-186" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-187"><a href="app-code.html#cb5-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-188"><a href="app-code.html#cb5-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-189"><a href="app-code.html#cb5-189" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-190"><a href="app-code.html#cb5-190" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-191"><a href="app-code.html#cb5-191" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-192"><a href="app-code.html#cb5-192" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-193"><a href="app-code.html#cb5-193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb5-194"><a href="app-code.html#cb5-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-195"><a href="app-code.html#cb5-195" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-196"><a href="app-code.html#cb5-196" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-197"><a href="app-code.html#cb5-197" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-198"><a href="app-code.html#cb5-198" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-199"><a href="app-code.html#cb5-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-200"><a href="app-code.html#cb5-200" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-201"><a href="app-code.html#cb5-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-202"><a href="app-code.html#cb5-202" aria-hidden="true" tabindex="-1"></a>science_pair_count <span class="ot">&lt;-</span> list_pair_count <span class="sc">%&gt;%</span></span>
<span id="cb5-203"><a href="app-code.html#cb5-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list <span class="sc">==</span> <span class="st">&quot;science&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-204"><a href="app-code.html#cb5-204" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(n &gt;= 25) %&gt;%</span></span>
<span id="cb5-205"><a href="app-code.html#cb5-205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-206"><a href="app-code.html#cb5-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-207"><a href="app-code.html#cb5-207" aria-hidden="true" tabindex="-1"></a>science_graph_pair <span class="ot">&lt;-</span> science_pair_count <span class="sc">%&gt;%</span></span>
<span id="cb5-208"><a href="app-code.html#cb5-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-209"><a href="app-code.html#cb5-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-210"><a href="app-code.html#cb5-210" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>(), <span class="co"># Centrality</span></span>
<span id="cb5-211"><a href="app-code.html#cb5-211" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="fu">group_infomap</span>())</span>
<span id="cb5-212"><a href="app-code.html#cb5-212" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># Community</span></span>
<span id="cb5-213"><a href="app-code.html#cb5-213" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-214"><a href="app-code.html#cb5-214" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(science_graph_pair, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-215"><a href="app-code.html#cb5-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-216"><a href="app-code.html#cb5-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-217"><a href="app-code.html#cb5-217" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb5-218"><a href="app-code.html#cb5-218" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-219"><a href="app-code.html#cb5-219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-220"><a href="app-code.html#cb5-220" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-221"><a href="app-code.html#cb5-221" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-222"><a href="app-code.html#cb5-222" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-223"><a href="app-code.html#cb5-223" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-224"><a href="app-code.html#cb5-224" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-225"><a href="app-code.html#cb5-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb5-226"><a href="app-code.html#cb5-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-227"><a href="app-code.html#cb5-227" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-228"><a href="app-code.html#cb5-228" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-229"><a href="app-code.html#cb5-229" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-230"><a href="app-code.html#cb5-230" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-231"><a href="app-code.html#cb5-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-232"><a href="app-code.html#cb5-232" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-233"><a href="app-code.html#cb5-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-234"><a href="app-code.html#cb5-234" aria-hidden="true" tabindex="-1"></a>arts_pair_count <span class="ot">&lt;-</span> list_pair_count <span class="sc">%&gt;%</span></span>
<span id="cb5-235"><a href="app-code.html#cb5-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list <span class="sc">==</span> <span class="st">&quot;arts&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-236"><a href="app-code.html#cb5-236" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(n &gt;= 25) %&gt;%</span></span>
<span id="cb5-237"><a href="app-code.html#cb5-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-238"><a href="app-code.html#cb5-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-239"><a href="app-code.html#cb5-239" aria-hidden="true" tabindex="-1"></a>arts_graph_pair <span class="ot">&lt;-</span> arts_pair_count <span class="sc">%&gt;%</span></span>
<span id="cb5-240"><a href="app-code.html#cb5-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-241"><a href="app-code.html#cb5-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-242"><a href="app-code.html#cb5-242" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>(), <span class="co"># Centrality</span></span>
<span id="cb5-243"><a href="app-code.html#cb5-243" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="fu">group_infomap</span>())</span>
<span id="cb5-244"><a href="app-code.html#cb5-244" aria-hidden="true" tabindex="-1"></a>  ) <span class="co"># Community</span></span>
<span id="cb5-245"><a href="app-code.html#cb5-245" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-246"><a href="app-code.html#cb5-246" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(arts_graph_pair, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-247"><a href="app-code.html#cb5-247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-248"><a href="app-code.html#cb5-248" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-249"><a href="app-code.html#cb5-249" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb5-250"><a href="app-code.html#cb5-250" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-251"><a href="app-code.html#cb5-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-252"><a href="app-code.html#cb5-252" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-253"><a href="app-code.html#cb5-253" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-254"><a href="app-code.html#cb5-254" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-255"><a href="app-code.html#cb5-255" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-256"><a href="app-code.html#cb5-256" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-257"><a href="app-code.html#cb5-257" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>)) <span class="sc">+</span></span>
<span id="cb5-258"><a href="app-code.html#cb5-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-259"><a href="app-code.html#cb5-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-260"><a href="app-code.html#cb5-260" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-261"><a href="app-code.html#cb5-261" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-262"><a href="app-code.html#cb5-262" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-263"><a href="app-code.html#cb5-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-264"><a href="app-code.html#cb5-264" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-265"><a href="app-code.html#cb5-265" aria-hidden="true" tabindex="-1"></a>cs_word_cors <span class="ot">&lt;-</span> list_word_cors <span class="sc">%&gt;%</span></span>
<span id="cb5-266"><a href="app-code.html#cb5-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list <span class="sc">==</span> <span class="st">&quot;cs&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-267"><a href="app-code.html#cb5-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(correlation, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-268"><a href="app-code.html#cb5-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-269"><a href="app-code.html#cb5-269" aria-hidden="true" tabindex="-1"></a>cs_graph_cors <span class="ot">&lt;-</span> cs_word_cors <span class="sc">%&gt;%</span></span>
<span id="cb5-270"><a href="app-code.html#cb5-270" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gt::gt()</span></span>
<span id="cb5-271"><a href="app-code.html#cb5-271" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(correlation &gt;= 0.15) %&gt;%</span></span>
<span id="cb5-272"><a href="app-code.html#cb5-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-273"><a href="app-code.html#cb5-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-274"><a href="app-code.html#cb5-274" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb5-275"><a href="app-code.html#cb5-275" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="fu">group_infomap</span>())</span>
<span id="cb5-276"><a href="app-code.html#cb5-276" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-277"><a href="app-code.html#cb5-277" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-278"><a href="app-code.html#cb5-278" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(cs_graph_cors, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-279"><a href="app-code.html#cb5-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-280"><a href="app-code.html#cb5-280" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-281"><a href="app-code.html#cb5-281" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb5-282"><a href="app-code.html#cb5-282" aria-hidden="true" tabindex="-1"></a>      <span class="at">edge_alpha =</span> correlation,</span>
<span id="cb5-283"><a href="app-code.html#cb5-283" aria-hidden="true" tabindex="-1"></a>      <span class="at">edge_width =</span> correlation</span>
<span id="cb5-284"><a href="app-code.html#cb5-284" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-285"><a href="app-code.html#cb5-285" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb5-286"><a href="app-code.html#cb5-286" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-287"><a href="app-code.html#cb5-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb5-288"><a href="app-code.html#cb5-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-289"><a href="app-code.html#cb5-289" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-290"><a href="app-code.html#cb5-290" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-291"><a href="app-code.html#cb5-291" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-292"><a href="app-code.html#cb5-292" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-293"><a href="app-code.html#cb5-293" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-294"><a href="app-code.html#cb5-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb5-295"><a href="app-code.html#cb5-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-296"><a href="app-code.html#cb5-296" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-297"><a href="app-code.html#cb5-297" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-298"><a href="app-code.html#cb5-298" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-299"><a href="app-code.html#cb5-299" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-300"><a href="app-code.html#cb5-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-301"><a href="app-code.html#cb5-301" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-302"><a href="app-code.html#cb5-302" aria-hidden="true" tabindex="-1"></a>math_word_cors <span class="ot">&lt;-</span> list_word_cors <span class="sc">%&gt;%</span></span>
<span id="cb5-303"><a href="app-code.html#cb5-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list <span class="sc">==</span> <span class="st">&quot;math&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-304"><a href="app-code.html#cb5-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(correlation, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-305"><a href="app-code.html#cb5-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-306"><a href="app-code.html#cb5-306" aria-hidden="true" tabindex="-1"></a>math_graph_cors <span class="ot">&lt;-</span> math_word_cors <span class="sc">%&gt;%</span></span>
<span id="cb5-307"><a href="app-code.html#cb5-307" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gt::gt()</span></span>
<span id="cb5-308"><a href="app-code.html#cb5-308" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(correlation &gt;= 0.15) %&gt;%</span></span>
<span id="cb5-309"><a href="app-code.html#cb5-309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-310"><a href="app-code.html#cb5-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-311"><a href="app-code.html#cb5-311" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb5-312"><a href="app-code.html#cb5-312" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="fu">group_infomap</span>())</span>
<span id="cb5-313"><a href="app-code.html#cb5-313" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-314"><a href="app-code.html#cb5-314" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-315"><a href="app-code.html#cb5-315" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(math_graph_cors, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-316"><a href="app-code.html#cb5-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-317"><a href="app-code.html#cb5-317" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-318"><a href="app-code.html#cb5-318" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb5-319"><a href="app-code.html#cb5-319" aria-hidden="true" tabindex="-1"></a>      <span class="at">edge_alpha =</span> correlation,</span>
<span id="cb5-320"><a href="app-code.html#cb5-320" aria-hidden="true" tabindex="-1"></a>      <span class="at">edge_width =</span> correlation</span>
<span id="cb5-321"><a href="app-code.html#cb5-321" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-322"><a href="app-code.html#cb5-322" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb5-323"><a href="app-code.html#cb5-323" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-324"><a href="app-code.html#cb5-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb5-325"><a href="app-code.html#cb5-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-326"><a href="app-code.html#cb5-326" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-327"><a href="app-code.html#cb5-327" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-328"><a href="app-code.html#cb5-328" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-329"><a href="app-code.html#cb5-329" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-330"><a href="app-code.html#cb5-330" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-331"><a href="app-code.html#cb5-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb5-332"><a href="app-code.html#cb5-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-333"><a href="app-code.html#cb5-333" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-334"><a href="app-code.html#cb5-334" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-335"><a href="app-code.html#cb5-335" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-336"><a href="app-code.html#cb5-336" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-337"><a href="app-code.html#cb5-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-338"><a href="app-code.html#cb5-338" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-339"><a href="app-code.html#cb5-339" aria-hidden="true" tabindex="-1"></a>science_word_cors <span class="ot">&lt;-</span> list_word_cors <span class="sc">%&gt;%</span></span>
<span id="cb5-340"><a href="app-code.html#cb5-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list <span class="sc">==</span> <span class="st">&quot;science&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-341"><a href="app-code.html#cb5-341" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(correlation, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-342"><a href="app-code.html#cb5-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-343"><a href="app-code.html#cb5-343" aria-hidden="true" tabindex="-1"></a>science_graph_cors <span class="ot">&lt;-</span> science_word_cors <span class="sc">%&gt;%</span></span>
<span id="cb5-344"><a href="app-code.html#cb5-344" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gt::gt()</span></span>
<span id="cb5-345"><a href="app-code.html#cb5-345" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(correlation &gt;= 0.15) %&gt;%</span></span>
<span id="cb5-346"><a href="app-code.html#cb5-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-347"><a href="app-code.html#cb5-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-348"><a href="app-code.html#cb5-348" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb5-349"><a href="app-code.html#cb5-349" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="fu">group_infomap</span>())</span>
<span id="cb5-350"><a href="app-code.html#cb5-350" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-351"><a href="app-code.html#cb5-351" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-352"><a href="app-code.html#cb5-352" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(science_graph_cors, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-353"><a href="app-code.html#cb5-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-354"><a href="app-code.html#cb5-354" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-355"><a href="app-code.html#cb5-355" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb5-356"><a href="app-code.html#cb5-356" aria-hidden="true" tabindex="-1"></a>      <span class="at">edge_alpha =</span> correlation,</span>
<span id="cb5-357"><a href="app-code.html#cb5-357" aria-hidden="true" tabindex="-1"></a>      <span class="at">edge_width =</span> correlation</span>
<span id="cb5-358"><a href="app-code.html#cb5-358" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-359"><a href="app-code.html#cb5-359" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb5-360"><a href="app-code.html#cb5-360" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-361"><a href="app-code.html#cb5-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb5-362"><a href="app-code.html#cb5-362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-363"><a href="app-code.html#cb5-363" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-364"><a href="app-code.html#cb5-364" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-365"><a href="app-code.html#cb5-365" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-366"><a href="app-code.html#cb5-366" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-367"><a href="app-code.html#cb5-367" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-368"><a href="app-code.html#cb5-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb5-369"><a href="app-code.html#cb5-369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-370"><a href="app-code.html#cb5-370" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-371"><a href="app-code.html#cb5-371" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-372"><a href="app-code.html#cb5-372" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-373"><a href="app-code.html#cb5-373" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-374"><a href="app-code.html#cb5-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-375"><a href="app-code.html#cb5-375" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-376"><a href="app-code.html#cb5-376" aria-hidden="true" tabindex="-1"></a>arts_word_cors <span class="ot">&lt;-</span> list_word_cors <span class="sc">%&gt;%</span></span>
<span id="cb5-377"><a href="app-code.html#cb5-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list <span class="sc">==</span> <span class="st">&quot;arts&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-378"><a href="app-code.html#cb5-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(correlation, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-379"><a href="app-code.html#cb5-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-380"><a href="app-code.html#cb5-380" aria-hidden="true" tabindex="-1"></a>arts_graph_cors <span class="ot">&lt;-</span> arts_word_cors <span class="sc">%&gt;%</span></span>
<span id="cb5-381"><a href="app-code.html#cb5-381" aria-hidden="true" tabindex="-1"></a>  <span class="co"># gt::gt()</span></span>
<span id="cb5-382"><a href="app-code.html#cb5-382" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(correlation &gt;= 0.15) %&gt;%</span></span>
<span id="cb5-383"><a href="app-code.html#cb5-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-384"><a href="app-code.html#cb5-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-385"><a href="app-code.html#cb5-385" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb5-386"><a href="app-code.html#cb5-386" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="fu">group_infomap</span>())</span>
<span id="cb5-387"><a href="app-code.html#cb5-387" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-388"><a href="app-code.html#cb5-388" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-389"><a href="app-code.html#cb5-389" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(arts_graph_cors, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-390"><a href="app-code.html#cb5-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-391"><a href="app-code.html#cb5-391" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-392"><a href="app-code.html#cb5-392" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb5-393"><a href="app-code.html#cb5-393" aria-hidden="true" tabindex="-1"></a>      <span class="at">edge_alpha =</span> correlation,</span>
<span id="cb5-394"><a href="app-code.html#cb5-394" aria-hidden="true" tabindex="-1"></a>      <span class="at">edge_width =</span> correlation</span>
<span id="cb5-395"><a href="app-code.html#cb5-395" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb5-396"><a href="app-code.html#cb5-396" aria-hidden="true" tabindex="-1"></a>    <span class="at">show.legend =</span> F</span>
<span id="cb5-397"><a href="app-code.html#cb5-397" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-398"><a href="app-code.html#cb5-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_edge_width</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb5-399"><a href="app-code.html#cb5-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-400"><a href="app-code.html#cb5-400" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-401"><a href="app-code.html#cb5-401" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-402"><a href="app-code.html#cb5-402" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-403"><a href="app-code.html#cb5-403" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-404"><a href="app-code.html#cb5-404" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-405"><a href="app-code.html#cb5-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb5-406"><a href="app-code.html#cb5-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-407"><a href="app-code.html#cb5-407" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-408"><a href="app-code.html#cb5-408" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-409"><a href="app-code.html#cb5-409" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-410"><a href="app-code.html#cb5-410" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-411"><a href="app-code.html#cb5-411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-412"><a href="app-code.html#cb5-412" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-413"><a href="app-code.html#cb5-413" aria-hidden="true" tabindex="-1"></a>cs_bigram <span class="ot">&lt;-</span> pair_bigram <span class="sc">%&gt;%</span></span>
<span id="cb5-414"><a href="app-code.html#cb5-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list <span class="sc">==</span> <span class="st">&quot;cs&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-415"><a href="app-code.html#cb5-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>list) <span class="sc">%&gt;%</span></span>
<span id="cb5-416"><a href="app-code.html#cb5-416" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(n &gt;= 8) %&gt;%</span></span>
<span id="cb5-417"><a href="app-code.html#cb5-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-418"><a href="app-code.html#cb5-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-419"><a href="app-code.html#cb5-419" aria-hidden="true" tabindex="-1"></a>cs_graph_bigram <span class="ot">&lt;-</span> cs_bigram <span class="sc">%&gt;%</span></span>
<span id="cb5-420"><a href="app-code.html#cb5-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-421"><a href="app-code.html#cb5-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-422"><a href="app-code.html#cb5-422" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb5-423"><a href="app-code.html#cb5-423" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="fu">group_infomap</span>())</span>
<span id="cb5-424"><a href="app-code.html#cb5-424" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-425"><a href="app-code.html#cb5-425" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-426"><a href="app-code.html#cb5-426" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(cs_graph_bigram, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-427"><a href="app-code.html#cb5-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-428"><a href="app-code.html#cb5-428" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-429"><a href="app-code.html#cb5-429" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb5-430"><a href="app-code.html#cb5-430" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-431"><a href="app-code.html#cb5-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-432"><a href="app-code.html#cb5-432" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-433"><a href="app-code.html#cb5-433" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-434"><a href="app-code.html#cb5-434" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-435"><a href="app-code.html#cb5-435" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-436"><a href="app-code.html#cb5-436" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-437"><a href="app-code.html#cb5-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb5-438"><a href="app-code.html#cb5-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-439"><a href="app-code.html#cb5-439" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-440"><a href="app-code.html#cb5-440" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-441"><a href="app-code.html#cb5-441" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-442"><a href="app-code.html#cb5-442" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-443"><a href="app-code.html#cb5-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-444"><a href="app-code.html#cb5-444" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-445"><a href="app-code.html#cb5-445" aria-hidden="true" tabindex="-1"></a>math_bigram <span class="ot">&lt;-</span> pair_bigram <span class="sc">%&gt;%</span></span>
<span id="cb5-446"><a href="app-code.html#cb5-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list <span class="sc">==</span> <span class="st">&quot;math&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-447"><a href="app-code.html#cb5-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>list) <span class="sc">%&gt;%</span></span>
<span id="cb5-448"><a href="app-code.html#cb5-448" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(n &gt;= 8) %&gt;%</span></span>
<span id="cb5-449"><a href="app-code.html#cb5-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-450"><a href="app-code.html#cb5-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-451"><a href="app-code.html#cb5-451" aria-hidden="true" tabindex="-1"></a>math_graph_bigram <span class="ot">&lt;-</span> math_bigram <span class="sc">%&gt;%</span></span>
<span id="cb5-452"><a href="app-code.html#cb5-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-453"><a href="app-code.html#cb5-453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-454"><a href="app-code.html#cb5-454" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb5-455"><a href="app-code.html#cb5-455" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="fu">group_infomap</span>())</span>
<span id="cb5-456"><a href="app-code.html#cb5-456" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-457"><a href="app-code.html#cb5-457" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-458"><a href="app-code.html#cb5-458" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(math_graph_bigram, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-459"><a href="app-code.html#cb5-459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-460"><a href="app-code.html#cb5-460" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-461"><a href="app-code.html#cb5-461" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb5-462"><a href="app-code.html#cb5-462" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-463"><a href="app-code.html#cb5-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-464"><a href="app-code.html#cb5-464" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-465"><a href="app-code.html#cb5-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-466"><a href="app-code.html#cb5-466" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-467"><a href="app-code.html#cb5-467" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-468"><a href="app-code.html#cb5-468" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-469"><a href="app-code.html#cb5-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb5-470"><a href="app-code.html#cb5-470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-471"><a href="app-code.html#cb5-471" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-472"><a href="app-code.html#cb5-472" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-473"><a href="app-code.html#cb5-473" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-474"><a href="app-code.html#cb5-474" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-475"><a href="app-code.html#cb5-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-476"><a href="app-code.html#cb5-476" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-477"><a href="app-code.html#cb5-477" aria-hidden="true" tabindex="-1"></a>science_bigram <span class="ot">&lt;-</span> pair_bigram <span class="sc">%&gt;%</span></span>
<span id="cb5-478"><a href="app-code.html#cb5-478" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list <span class="sc">==</span> <span class="st">&quot;science&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-479"><a href="app-code.html#cb5-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>list) <span class="sc">%&gt;%</span></span>
<span id="cb5-480"><a href="app-code.html#cb5-480" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(n &gt;= 8) %&gt;%</span></span>
<span id="cb5-481"><a href="app-code.html#cb5-481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-482"><a href="app-code.html#cb5-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-483"><a href="app-code.html#cb5-483" aria-hidden="true" tabindex="-1"></a>science_graph_bigram <span class="ot">&lt;-</span> science_bigram <span class="sc">%&gt;%</span></span>
<span id="cb5-484"><a href="app-code.html#cb5-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-485"><a href="app-code.html#cb5-485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-486"><a href="app-code.html#cb5-486" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb5-487"><a href="app-code.html#cb5-487" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="fu">group_infomap</span>())</span>
<span id="cb5-488"><a href="app-code.html#cb5-488" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-489"><a href="app-code.html#cb5-489" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-490"><a href="app-code.html#cb5-490" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(science_graph_bigram, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-491"><a href="app-code.html#cb5-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-492"><a href="app-code.html#cb5-492" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-493"><a href="app-code.html#cb5-493" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb5-494"><a href="app-code.html#cb5-494" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-495"><a href="app-code.html#cb5-495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-496"><a href="app-code.html#cb5-496" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-497"><a href="app-code.html#cb5-497" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-498"><a href="app-code.html#cb5-498" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-499"><a href="app-code.html#cb5-499" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-500"><a href="app-code.html#cb5-500" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-501"><a href="app-code.html#cb5-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb5-502"><a href="app-code.html#cb5-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-503"><a href="app-code.html#cb5-503" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-504"><a href="app-code.html#cb5-504" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-505"><a href="app-code.html#cb5-505" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-506"><a href="app-code.html#cb5-506" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-507"><a href="app-code.html#cb5-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-508"><a href="app-code.html#cb5-508" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-509"><a href="app-code.html#cb5-509" aria-hidden="true" tabindex="-1"></a>arts_bigram <span class="ot">&lt;-</span> pair_bigram <span class="sc">%&gt;%</span></span>
<span id="cb5-510"><a href="app-code.html#cb5-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(list <span class="sc">==</span> <span class="st">&quot;arts&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-511"><a href="app-code.html#cb5-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>list) <span class="sc">%&gt;%</span></span>
<span id="cb5-512"><a href="app-code.html#cb5-512" aria-hidden="true" tabindex="-1"></a>  <span class="co"># filter(n &gt;= 8) %&gt;%</span></span>
<span id="cb5-513"><a href="app-code.html#cb5-513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-514"><a href="app-code.html#cb5-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-515"><a href="app-code.html#cb5-515" aria-hidden="true" tabindex="-1"></a>arts_graph_bigram <span class="ot">&lt;-</span> arts_bigram <span class="sc">%&gt;%</span></span>
<span id="cb5-516"><a href="app-code.html#cb5-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-517"><a href="app-code.html#cb5-517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-518"><a href="app-code.html#cb5-518" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb5-519"><a href="app-code.html#cb5-519" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">as.factor</span>(<span class="fu">group_infomap</span>())</span>
<span id="cb5-520"><a href="app-code.html#cb5-520" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-521"><a href="app-code.html#cb5-521" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7777</span>)</span>
<span id="cb5-522"><a href="app-code.html#cb5-522" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(arts_graph_bigram, <span class="at">layout =</span> <span class="st">&quot;fr&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-523"><a href="app-code.html#cb5-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(</span>
<span id="cb5-524"><a href="app-code.html#cb5-524" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;gray50&quot;</span>,</span>
<span id="cb5-525"><a href="app-code.html#cb5-525" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb5-526"><a href="app-code.html#cb5-526" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-527"><a href="app-code.html#cb5-527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(</span>
<span id="cb5-528"><a href="app-code.html#cb5-528" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> centrality,</span>
<span id="cb5-529"><a href="app-code.html#cb5-529" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> group</span>
<span id="cb5-530"><a href="app-code.html#cb5-530" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb5-531"><a href="app-code.html#cb5-531" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.legend =</span> F</span>
<span id="cb5-532"><a href="app-code.html#cb5-532" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-533"><a href="app-code.html#cb5-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb5-534"><a href="app-code.html#cb5-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name),</span>
<span id="cb5-535"><a href="app-code.html#cb5-535" aria-hidden="true" tabindex="-1"></a>    <span class="at">repel =</span> T,</span>
<span id="cb5-536"><a href="app-code.html#cb5-536" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">5</span>,</span>
<span id="cb5-537"><a href="app-code.html#cb5-537" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-538"><a href="app-code.html#cb5-538" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-539"><a href="app-code.html#cb5-539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span>
<span id="cb5-540"><a href="app-code.html#cb5-540" aria-hidden="true" tabindex="-1"></a><span class="co"># R code used for structural topic modeling</span></span>
<span id="cb5-541"><a href="app-code.html#cb5-541" aria-hidden="true" tabindex="-1"></a><span class="do">### Preprocessing</span></span>
<span id="cb5-542"><a href="app-code.html#cb5-542" aria-hidden="true" tabindex="-1"></a><span class="co"># Making sparse object:</span></span>
<span id="cb5-543"><a href="app-code.html#cb5-543" aria-hidden="true" tabindex="-1"></a>df_sparse <span class="ot">&lt;-</span> df_bow <span class="sc">%&gt;%</span></span>
<span id="cb5-544"><a href="app-code.html#cb5-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(document) <span class="sc">%&gt;%</span></span>
<span id="cb5-545"><a href="app-code.html#cb5-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(word, <span class="at">.keep_all =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb5-546"><a href="app-code.html#cb5-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-547"><a href="app-code.html#cb5-547" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(document, word) <span class="sc">%&gt;%</span></span>
<span id="cb5-548"><a href="app-code.html#cb5-548" aria-hidden="true" tabindex="-1"></a>  tidytext<span class="sc">::</span><span class="fu">cast_sparse</span>(document, word, n)</span>
<span id="cb5-549"><a href="app-code.html#cb5-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-550"><a href="app-code.html#cb5-550" aria-hidden="true" tabindex="-1"></a>beepr<span class="sc">::</span><span class="fu">beep</span>(<span class="dv">10</span>)</span>
<span id="cb5-551"><a href="app-code.html#cb5-551" aria-hidden="true" tabindex="-1"></a>covariate_df <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">document =</span> base<span class="sc">::</span><span class="fu">rownames</span>(df_sparse)) <span class="sc">%&gt;%</span></span>
<span id="cb5-552"><a href="app-code.html#cb5-552" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(df_document, <span class="at">by =</span> <span class="st">&quot;document&quot;</span>)</span>
<span id="cb5-553"><a href="app-code.html#cb5-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-554"><a href="app-code.html#cb5-554" aria-hidden="true" tabindex="-1"></a>beepr<span class="sc">::</span><span class="fu">beep</span>(<span class="dv">10</span>)</span>
<span id="cb5-555"><a href="app-code.html#cb5-555" aria-hidden="true" tabindex="-1"></a><span class="do">### Tuning</span></span>
<span id="cb5-556"><a href="app-code.html#cb5-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-557"><a href="app-code.html#cb5-557" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stm)</span>
<span id="cb5-558"><a href="app-code.html#cb5-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-559"><a href="app-code.html#cb5-559" aria-hidden="true" tabindex="-1"></a><span class="fu">gc</span>()</span>
<span id="cb5-560"><a href="app-code.html#cb5-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-561"><a href="app-code.html#cb5-561" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>(<span class="st">&quot;STM fitting&quot;</span>)</span>
<span id="cb5-562"><a href="app-code.html#cb5-562" aria-hidden="true" tabindex="-1"></a><span class="co"># STM</span></span>
<span id="cb5-563"><a href="app-code.html#cb5-563" aria-hidden="true" tabindex="-1"></a>many_models <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">K =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-564"><a href="app-code.html#cb5-564" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">topic_model =</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(K, <span class="sc">~</span> stm<span class="sc">::</span><span class="fu">stm</span>(df_sparse,</span>
<span id="cb5-565"><a href="app-code.html#cb5-565" aria-hidden="true" tabindex="-1"></a>    <span class="at">K =</span> .,</span>
<span id="cb5-566"><a href="app-code.html#cb5-566" aria-hidden="true" tabindex="-1"></a>    <span class="at">prevalence =</span> <span class="sc">~</span> list <span class="sc">+</span> <span class="fu">s</span>(year),</span>
<span id="cb5-567"><a href="app-code.html#cb5-567" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> covariate_df,</span>
<span id="cb5-568"><a href="app-code.html#cb5-568" aria-hidden="true" tabindex="-1"></a>    <span class="at">seed =</span> <span class="dv">7777</span>,</span>
<span id="cb5-569"><a href="app-code.html#cb5-569" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb5-570"><a href="app-code.html#cb5-570" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">.options =</span> furrr<span class="sc">::</span><span class="fu">furrr_options</span>(<span class="at">seed =</span> <span class="dv">123</span>)))</span>
<span id="cb5-571"><a href="app-code.html#cb5-571" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span>
<span id="cb5-572"><a href="app-code.html#cb5-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-573"><a href="app-code.html#cb5-573" aria-hidden="true" tabindex="-1"></a>beepr<span class="sc">::</span><span class="fu">beep</span>(<span class="dv">10</span>)</span>
<span id="cb5-574"><a href="app-code.html#cb5-574" aria-hidden="true" tabindex="-1"></a>heldout <span class="ot">&lt;-</span> stm<span class="sc">::</span><span class="fu">make.heldout</span>(df_sparse)</span>
<span id="cb5-575"><a href="app-code.html#cb5-575" aria-hidden="true" tabindex="-1"></a>beepr<span class="sc">::</span><span class="fu">beep</span>(<span class="dv">10</span>)</span>
<span id="cb5-576"><a href="app-code.html#cb5-576" aria-hidden="true" tabindex="-1"></a>k_result <span class="ot">&lt;-</span> many_models <span class="sc">%&gt;%</span></span>
<span id="cb5-577"><a href="app-code.html#cb5-577" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb5-578"><a href="app-code.html#cb5-578" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Comment out exclusivity (not applicable for models with content covariates:</span></span>
<span id="cb5-579"><a href="app-code.html#cb5-579" aria-hidden="true" tabindex="-1"></a>    <span class="at">exclusivity =</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(topic_model, exclusivity),</span>
<span id="cb5-580"><a href="app-code.html#cb5-580" aria-hidden="true" tabindex="-1"></a>    <span class="at">semantic_coherence =</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(topic_model, semanticCoherence, df_sparse),</span>
<span id="cb5-581"><a href="app-code.html#cb5-581" aria-hidden="true" tabindex="-1"></a>    <span class="at">eval_heldout =</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(topic_model, eval.heldout, heldout<span class="sc">$</span>missing),</span>
<span id="cb5-582"><a href="app-code.html#cb5-582" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> furrr<span class="sc">::</span><span class="fu">future_map</span>(topic_model, checkResiduals, df_sparse),</span>
<span id="cb5-583"><a href="app-code.html#cb5-583" aria-hidden="true" tabindex="-1"></a>    <span class="at">bound =</span> furrr<span class="sc">::</span><span class="fu">future_map_dbl</span>(topic_model, <span class="cf">function</span>(x) <span class="fu">max</span>(x<span class="sc">$</span>convergence<span class="sc">$</span>bound)),</span>
<span id="cb5-584"><a href="app-code.html#cb5-584" aria-hidden="true" tabindex="-1"></a>    <span class="at">lfact =</span> furrr<span class="sc">::</span><span class="fu">future_map_dbl</span>(topic_model, <span class="cf">function</span>(x) <span class="fu">lfactorial</span>(x<span class="sc">$</span>settings<span class="sc">$</span>dim<span class="sc">$</span>K)),</span>
<span id="cb5-585"><a href="app-code.html#cb5-585" aria-hidden="true" tabindex="-1"></a>    <span class="at">lbound =</span> bound <span class="sc">+</span> lfact,</span>
<span id="cb5-586"><a href="app-code.html#cb5-586" aria-hidden="true" tabindex="-1"></a>    <span class="at">iterations =</span> furrr<span class="sc">::</span><span class="fu">future_map_dbl</span>(topic_model, <span class="cf">function</span>(x) <span class="fu">length</span>(x<span class="sc">$</span>convergence<span class="sc">$</span>bound))</span>
<span id="cb5-587"><a href="app-code.html#cb5-587" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-588"><a href="app-code.html#cb5-588" aria-hidden="true" tabindex="-1"></a>beepr<span class="sc">::</span><span class="fu">beep</span>(<span class="dv">10</span>)</span>
<span id="cb5-589"><a href="app-code.html#cb5-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-590"><a href="app-code.html#cb5-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-591"><a href="app-code.html#cb5-591" aria-hidden="true" tabindex="-1"></a>k_result_df <span class="ot">&lt;-</span> k_result <span class="sc">%&gt;%</span></span>
<span id="cb5-592"><a href="app-code.html#cb5-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(K,</span>
<span id="cb5-593"><a href="app-code.html#cb5-593" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Lower bound</span><span class="st">`</span> <span class="ot">=</span> lbound,</span>
<span id="cb5-594"><a href="app-code.html#cb5-594" aria-hidden="true" tabindex="-1"></a>    <span class="at">Residuals =</span> furrr<span class="sc">::</span><span class="fu">future_map_dbl</span>(residual, <span class="st">&quot;dispersion&quot;</span>),</span>
<span id="cb5-595"><a href="app-code.html#cb5-595" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Semantic coherence</span><span class="st">`</span> <span class="ot">=</span> furrr<span class="sc">::</span><span class="fu">future_map_dbl</span>(semantic_coherence, mean),</span>
<span id="cb5-596"><a href="app-code.html#cb5-596" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Held-out likelihood</span><span class="st">`</span> <span class="ot">=</span> furrr<span class="sc">::</span><span class="fu">future_map_dbl</span>(eval_heldout, <span class="st">&quot;expected.heldout&quot;</span>)</span>
<span id="cb5-597"><a href="app-code.html#cb5-597" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-598"><a href="app-code.html#cb5-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-599"><a href="app-code.html#cb5-599" aria-hidden="true" tabindex="-1"></a>beepr<span class="sc">::</span><span class="fu">beep</span>(<span class="dv">10</span>)</span>
<span id="cb5-600"><a href="app-code.html#cb5-600" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization for diagnostic:</span></span>
<span id="cb5-601"><a href="app-code.html#cb5-601" aria-hidden="true" tabindex="-1"></a>g_diagnostic <span class="ot">&lt;-</span> k_result_df <span class="sc">%&gt;%</span></span>
<span id="cb5-602"><a href="app-code.html#cb5-602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(Metric, Value, <span class="sc">-</span>K) <span class="sc">%&gt;%</span></span>
<span id="cb5-603"><a href="app-code.html#cb5-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(K, Value, <span class="at">color =</span> Metric)) <span class="sc">+</span></span>
<span id="cb5-604"><a href="app-code.html#cb5-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb5-605"><a href="app-code.html#cb5-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Metric, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-606"><a href="app-code.html#cb5-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-607"><a href="app-code.html#cb5-607" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;K (number of topics)&quot;</span>,</span>
<span id="cb5-608"><a href="app-code.html#cb5-608" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="cn">NULL</span></span>
<span id="cb5-609"><a href="app-code.html#cb5-609" aria-hidden="true" tabindex="-1"></a>    <span class="co"># title = &quot;Model diagnostics by number of topics&quot;,</span></span>
<span id="cb5-610"><a href="app-code.html#cb5-610" aria-hidden="true" tabindex="-1"></a>    <span class="co"># subtitle = paste0(&quot;These diagnostics indicate that a good number of topics would be around &quot;, optimal_k)</span></span>
<span id="cb5-611"><a href="app-code.html#cb5-611" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-612"><a href="app-code.html#cb5-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-613"><a href="app-code.html#cb5-613" aria-hidden="true" tabindex="-1"></a>alt <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">capture.output</span>(BrailleR<span class="sc">::</span><span class="fu">VI</span>(g_diagnostic)), <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb5-614"><a href="app-code.html#cb5-614" aria-hidden="true" tabindex="-1"></a>g_diagnostic</span>
<span id="cb5-615"><a href="app-code.html#cb5-615" aria-hidden="true" tabindex="-1"></a><span class="co"># exclusivity</span></span>
<span id="cb5-616"><a href="app-code.html#cb5-616" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualization for the comparison between semantic coherence and exclusivity</span></span>
<span id="cb5-617"><a href="app-code.html#cb5-617" aria-hidden="true" tabindex="-1"></a>coherence_exclusivity <span class="ot">&lt;-</span> k_result <span class="sc">%&gt;%</span></span>
<span id="cb5-618"><a href="app-code.html#cb5-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(K, exclusivity, semantic_coherence) <span class="sc">%&gt;%</span></span>
<span id="cb5-619"><a href="app-code.html#cb5-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(K <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">20</span>, optimal_k, <span class="dv">100</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-620"><a href="app-code.html#cb5-620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(exclusivity, semantic_coherence)) <span class="sc">%&gt;%</span></span>
<span id="cb5-621"><a href="app-code.html#cb5-621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">K =</span> <span class="fu">as.factor</span>(K))</span>
<span id="cb5-622"><a href="app-code.html#cb5-622" aria-hidden="true" tabindex="-1"></a>g_coherence_exclusivity <span class="ot">&lt;-</span> coherence_exclusivity <span class="sc">%&gt;%</span></span>
<span id="cb5-623"><a href="app-code.html#cb5-623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(semantic_coherence, exclusivity, <span class="at">color =</span> K)) <span class="sc">+</span></span>
<span id="cb5-624"><a href="app-code.html#cb5-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb5-625"><a href="app-code.html#cb5-625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb5-626"><a href="app-code.html#cb5-626" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Semantic coherence&quot;</span>,</span>
<span id="cb5-627"><a href="app-code.html#cb5-627" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Exclusivity&quot;</span></span>
<span id="cb5-628"><a href="app-code.html#cb5-628" aria-hidden="true" tabindex="-1"></a>    <span class="co"># title = &quot;Comparing exclusivity and semantic coherence&quot;,</span></span>
<span id="cb5-629"><a href="app-code.html#cb5-629" aria-hidden="true" tabindex="-1"></a>    <span class="co"># subtitle = &quot;Models with fewer topics have higher semantic coherence than more topics, but lower exclusivity&quot;</span></span>
<span id="cb5-630"><a href="app-code.html#cb5-630" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-631"><a href="app-code.html#cb5-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-632"><a href="app-code.html#cb5-632" aria-hidden="true" tabindex="-1"></a>alt <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">capture.output</span>(BrailleR<span class="sc">::</span><span class="fu">VI</span>(g_coherence_exclusivity)), <span class="at">collapse =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb5-633"><a href="app-code.html#cb5-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-634"><a href="app-code.html#cb5-634" aria-hidden="true" tabindex="-1"></a>g_coherence_exclusivity</span>
<span id="cb5-635"><a href="app-code.html#cb5-635" aria-hidden="true" tabindex="-1"></a><span class="co"># Audio chart for semantic coherence and exclusivity</span></span>
<span id="cb5-636"><a href="app-code.html#cb5-636" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb5-637"><a href="app-code.html#cb5-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-638"><a href="app-code.html#cb5-638" aria-hidden="true" tabindex="-1"></a>coherence_exclusivity <span class="sc">%&gt;%</span></span>
<span id="cb5-639"><a href="app-code.html#cb5-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(K <span class="sc">==</span> optimal_k) <span class="sc">%$%</span></span>
<span id="cb5-640"><a href="app-code.html#cb5-640" aria-hidden="true" tabindex="-1"></a>  sonify<span class="sc">::</span><span class="fu">sonify</span>(<span class="at">x =</span> semantic_coherence, <span class="at">y =</span> exclusivity)</span>
<span id="cb5-641"><a href="app-code.html#cb5-641" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the ultimate model:</span></span>
<span id="cb5-642"><a href="app-code.html#cb5-642" aria-hidden="true" tabindex="-1"></a>stm_optimal_model <span class="ot">&lt;-</span> k_result <span class="sc">%&gt;%</span></span>
<span id="cb5-643"><a href="app-code.html#cb5-643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(K <span class="sc">==</span> optimal_k) <span class="sc">%&gt;%</span></span>
<span id="cb5-644"><a href="app-code.html#cb5-644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(topic_model) <span class="sc">%&gt;%</span></span>
<span id="cb5-645"><a href="app-code.html#cb5-645" aria-hidden="true" tabindex="-1"></a>  .[[<span class="dv">1</span>]]</span>
<span id="cb5-646"><a href="app-code.html#cb5-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-647"><a href="app-code.html#cb5-647" aria-hidden="true" tabindex="-1"></a>stm_optimal_model</span>
<span id="cb5-648"><a href="app-code.html#cb5-648" aria-hidden="true" tabindex="-1"></a><span class="do">### Output</span></span>
<span id="cb5-649"><a href="app-code.html#cb5-649" aria-hidden="true" tabindex="-1"></a><span class="do">#### Visualization</span></span>
<span id="cb5-650"><a href="app-code.html#cb5-650" aria-hidden="true" tabindex="-1"></a><span class="do">#### Topic-Term Matrix $\beta$</span></span>
<span id="cb5-651"><a href="app-code.html#cb5-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-652"><a href="app-code.html#cb5-652" aria-hidden="true" tabindex="-1"></a>stm_term_topic <span class="ot">&lt;-</span> <span class="fu">tidy</span>(stm_optimal_model, <span class="at">matrix =</span> <span class="st">&quot;beta&quot;</span>)</span>
<span id="cb5-653"><a href="app-code.html#cb5-653" aria-hidden="true" tabindex="-1"></a>stm_top_term_topic <span class="ot">&lt;-</span> stm_term_topic <span class="sc">%&gt;%</span></span>
<span id="cb5-654"><a href="app-code.html#cb5-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb5-655"><a href="app-code.html#cb5-655" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(beta, <span class="at">n =</span> <span class="dv">10</span>, <span class="at">with_ties =</span> F)</span>
<span id="cb5-656"><a href="app-code.html#cb5-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-657"><a href="app-code.html#cb5-657" aria-hidden="true" tabindex="-1"></a><span class="co"># gt::gt(stm_top_term_topic)</span></span>
<span id="cb5-658"><a href="app-code.html#cb5-658" aria-hidden="true" tabindex="-1"></a>stm_name_topic <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb5-659"><a href="app-code.html#cb5-659" aria-hidden="true" tabindex="-1"></a>  <span class="at">topic =</span> <span class="dv">1</span><span class="sc">:</span>optimal_k,</span>
<span id="cb5-660"><a href="app-code.html#cb5-660" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(</span>
<span id="cb5-661"><a href="app-code.html#cb5-661" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;1. &quot;</span>,</span>
<span id="cb5-662"><a href="app-code.html#cb5-662" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;2. &quot;</span>,</span>
<span id="cb5-663"><a href="app-code.html#cb5-663" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;3. &quot;</span>,</span>
<span id="cb5-664"><a href="app-code.html#cb5-664" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;4. &quot;</span>,</span>
<span id="cb5-665"><a href="app-code.html#cb5-665" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;5. &quot;</span>,</span>
<span id="cb5-666"><a href="app-code.html#cb5-666" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;6. &quot;</span>,</span>
<span id="cb5-667"><a href="app-code.html#cb5-667" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;7. &quot;</span>,</span>
<span id="cb5-668"><a href="app-code.html#cb5-668" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;8. &quot;</span>,</span>
<span id="cb5-669"><a href="app-code.html#cb5-669" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;9. &quot;</span>,</span>
<span id="cb5-670"><a href="app-code.html#cb5-670" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;10. &quot;</span>,</span>
<span id="cb5-671"><a href="app-code.html#cb5-671" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;11. &quot;</span>,</span>
<span id="cb5-672"><a href="app-code.html#cb5-672" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;12. &quot;</span>,</span>
<span id="cb5-673"><a href="app-code.html#cb5-673" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;13. &quot;</span>,</span>
<span id="cb5-674"><a href="app-code.html#cb5-674" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;14. &quot;</span>,</span>
<span id="cb5-675"><a href="app-code.html#cb5-675" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;15. &quot;</span>,</span>
<span id="cb5-676"><a href="app-code.html#cb5-676" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;16. &quot;</span>,</span>
<span id="cb5-677"><a href="app-code.html#cb5-677" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;17. &quot;</span>,</span>
<span id="cb5-678"><a href="app-code.html#cb5-678" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;18. &quot;</span>,</span>
<span id="cb5-679"><a href="app-code.html#cb5-679" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;19. &quot;</span>,</span>
<span id="cb5-680"><a href="app-code.html#cb5-680" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;20. &quot;</span>,</span>
<span id="cb5-681"><a href="app-code.html#cb5-681" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;21. &quot;</span>,</span>
<span id="cb5-682"><a href="app-code.html#cb5-682" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;22. &quot;</span>,</span>
<span id="cb5-683"><a href="app-code.html#cb5-683" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;23. &quot;</span>,</span>
<span id="cb5-684"><a href="app-code.html#cb5-684" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;24. &quot;</span>,</span>
<span id="cb5-685"><a href="app-code.html#cb5-685" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;25. &quot;</span>,</span>
<span id="cb5-686"><a href="app-code.html#cb5-686" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;26. &quot;</span>,</span>
<span id="cb5-687"><a href="app-code.html#cb5-687" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;27. &quot;</span>,</span>
<span id="cb5-688"><a href="app-code.html#cb5-688" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;28. &quot;</span>,</span>
<span id="cb5-689"><a href="app-code.html#cb5-689" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;29. &quot;</span>,</span>
<span id="cb5-690"><a href="app-code.html#cb5-690" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;30. &quot;</span>,</span>
<span id="cb5-691"><a href="app-code.html#cb5-691" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;31. &quot;</span>,</span>
<span id="cb5-692"><a href="app-code.html#cb5-692" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;32. &quot;</span>,</span>
<span id="cb5-693"><a href="app-code.html#cb5-693" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;33. &quot;</span>,</span>
<span id="cb5-694"><a href="app-code.html#cb5-694" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;34. &quot;</span>,</span>
<span id="cb5-695"><a href="app-code.html#cb5-695" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;35. &quot;</span>,</span>
<span id="cb5-696"><a href="app-code.html#cb5-696" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;36. &quot;</span>,</span>
<span id="cb5-697"><a href="app-code.html#cb5-697" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;37. &quot;</span>,</span>
<span id="cb5-698"><a href="app-code.html#cb5-698" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;38. &quot;</span>,</span>
<span id="cb5-699"><a href="app-code.html#cb5-699" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;39. &quot;</span>,</span>
<span id="cb5-700"><a href="app-code.html#cb5-700" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;40. &quot;</span></span>
<span id="cb5-701"><a href="app-code.html#cb5-701" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-702"><a href="app-code.html#cb5-702" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-703"><a href="app-code.html#cb5-703" aria-hidden="true" tabindex="-1"></a>stm_top_term_topic_name <span class="ot">&lt;-</span> stm_top_term_topic <span class="sc">%&gt;%</span></span>
<span id="cb5-704"><a href="app-code.html#cb5-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(stm_name_topic, , <span class="at">by =</span> <span class="st">&quot;topic&quot;</span>)</span>
<span id="cb5-705"><a href="app-code.html#cb5-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-706"><a href="app-code.html#cb5-706" aria-hidden="true" tabindex="-1"></a><span class="co"># gt::gt(stm_top_term_topic_name)</span></span>
<span id="cb5-707"><a href="app-code.html#cb5-707" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb5-708"><a href="app-code.html#cb5-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-709"><a href="app-code.html#cb5-709" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb5-710"><a href="app-code.html#cb5-710" aria-hidden="true" tabindex="-1"></a>  stm_top_term_topic_name,</span>
<span id="cb5-711"><a href="app-code.html#cb5-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb5-712"><a href="app-code.html#cb5-712" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">reorder_within</span>(term, beta, name),</span>
<span id="cb5-713"><a href="app-code.html#cb5-713" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> beta,</span>
<span id="cb5-714"><a href="app-code.html#cb5-714" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">factor</span>(topic)</span>
<span id="cb5-715"><a href="app-code.html#cb5-715" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-716"><a href="app-code.html#cb5-716" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb5-717"><a href="app-code.html#cb5-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb5-718"><a href="app-code.html#cb5-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb5-719"><a href="app-code.html#cb5-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb5-720"><a href="app-code.html#cb5-720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_reordered</span>() <span class="sc">+</span></span>
<span id="cb5-721"><a href="app-code.html#cb5-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb5-722"><a href="app-code.html#cb5-722" aria-hidden="true" tabindex="-1"></a>    <span class="at">n.breaks =</span> <span class="dv">4</span>,</span>
<span id="cb5-723"><a href="app-code.html#cb5-723" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">number_format</span>(<span class="at">accuracy =</span> .<span class="dv">01</span>)</span>
<span id="cb5-724"><a href="app-code.html#cb5-724" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-725"><a href="app-code.html#cb5-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb5-726"><a href="app-code.html#cb5-726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span>))</span>
<span id="cb5-727"><a href="app-code.html#cb5-727" aria-hidden="true" tabindex="-1"></a><span class="do">#### Document-Topic Matrix $\gamma$</span></span>
<span id="cb5-728"><a href="app-code.html#cb5-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-729"><a href="app-code.html#cb5-729" aria-hidden="true" tabindex="-1"></a>stm_doc_topic <span class="ot">&lt;-</span> <span class="fu">tidy</span>(stm_optimal_model, <span class="at">matrix =</span> <span class="st">&quot;theta&quot;</span>, <span class="at">document_names =</span> <span class="fu">rownames</span>(df_sparse))</span>
<span id="cb5-730"><a href="app-code.html#cb5-730" aria-hidden="true" tabindex="-1"></a>stm_doc_class <span class="ot">&lt;-</span> stm_doc_topic <span class="sc">%&gt;%</span></span>
<span id="cb5-731"><a href="app-code.html#cb5-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(document) <span class="sc">%&gt;%</span></span>
<span id="cb5-732"><a href="app-code.html#cb5-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(gamma, <span class="at">n =</span> <span class="dv">1</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-733"><a href="app-code.html#cb5-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-734"><a href="app-code.html#cb5-734" aria-hidden="true" tabindex="-1"></a><span class="co"># levels(factor(stm_doc_class$topic))</span></span>
<span id="cb5-735"><a href="app-code.html#cb5-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-736"><a href="app-code.html#cb5-736" aria-hidden="true" tabindex="-1"></a><span class="co"># class(stm_doc_class$document)</span></span>
<span id="cb5-737"><a href="app-code.html#cb5-737" aria-hidden="true" tabindex="-1"></a><span class="co"># stm_doc_class$document &lt;- as.character(stm_doc_class$document)</span></span>
<span id="cb5-738"><a href="app-code.html#cb5-738" aria-hidden="true" tabindex="-1"></a>stm_df_topic <span class="ot">&lt;-</span> df_document <span class="sc">%&gt;%</span></span>
<span id="cb5-739"><a href="app-code.html#cb5-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(stm_doc_class, <span class="at">by =</span> <span class="st">&quot;document&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-740"><a href="app-code.html#cb5-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb5-741"><a href="app-code.html#cb5-741" aria-hidden="true" tabindex="-1"></a>stm_top_terms <span class="ot">&lt;-</span> stm_term_topic <span class="sc">%&gt;%</span></span>
<span id="cb5-742"><a href="app-code.html#cb5-742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb5-743"><a href="app-code.html#cb5-743" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(beta, <span class="at">n =</span> <span class="dv">6</span>, <span class="at">with_ties =</span> F) <span class="sc">%&gt;%</span></span>
<span id="cb5-744"><a href="app-code.html#cb5-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">term =</span> <span class="fu">paste</span>(term, <span class="at">collapse =</span> <span class="st">&quot;, &quot;</span>))</span>
<span id="cb5-745"><a href="app-code.html#cb5-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-746"><a href="app-code.html#cb5-746" aria-hidden="true" tabindex="-1"></a><span class="co"># gt::gt(stm_top_terms)</span></span>
<span id="cb5-747"><a href="app-code.html#cb5-747" aria-hidden="true" tabindex="-1"></a>stm_count_topic <span class="ot">&lt;-</span> stm_df_topic <span class="sc">%&gt;%</span></span>
<span id="cb5-748"><a href="app-code.html#cb5-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(topic)</span>
<span id="cb5-749"><a href="app-code.html#cb5-749" aria-hidden="true" tabindex="-1"></a>stm_count_topic_word <span class="ot">&lt;-</span> stm_count_topic <span class="sc">%&gt;%</span></span>
<span id="cb5-750"><a href="app-code.html#cb5-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(stm_top_terms, <span class="at">by =</span> <span class="st">&quot;topic&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-751"><a href="app-code.html#cb5-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">topic_name =</span> <span class="fu">paste</span>(<span class="st">&quot;Topic&quot;</span>, topic))</span>
<span id="cb5-752"><a href="app-code.html#cb5-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-753"><a href="app-code.html#cb5-753" aria-hidden="true" tabindex="-1"></a><span class="co"># stm_count_topic_word %&gt;%</span></span>
<span id="cb5-754"><a href="app-code.html#cb5-754" aria-hidden="true" tabindex="-1"></a><span class="co">#     arrange(-n) %&gt;%</span></span>
<span id="cb5-755"><a href="app-code.html#cb5-755" aria-hidden="true" tabindex="-1"></a><span class="co">#     gt::gt()</span></span>
<span id="cb5-756"><a href="app-code.html#cb5-756" aria-hidden="true" tabindex="-1"></a>stm_count_topic_word_graph <span class="ot">&lt;-</span> stm_count_topic_word <span class="sc">%&gt;%</span></span>
<span id="cb5-757"><a href="app-code.html#cb5-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(n, <span class="at">n =</span> <span class="dv">16</span>, <span class="at">with_ties =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-758"><a href="app-code.html#cb5-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb5-759"><a href="app-code.html#cb5-759" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb5-760"><a href="app-code.html#cb5-760" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="fu">reorder</span>(topic_name, n),</span>
<span id="cb5-761"><a href="app-code.html#cb5-761" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> n,</span>
<span id="cb5-762"><a href="app-code.html#cb5-762" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> topic_name</span>
<span id="cb5-763"><a href="app-code.html#cb5-763" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-764"><a href="app-code.html#cb5-764" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-765"><a href="app-code.html#cb5-765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb5-766"><a href="app-code.html#cb5-766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb5-767"><a href="app-code.html#cb5-767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n),</span>
<span id="cb5-768"><a href="app-code.html#cb5-768" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span></span>
<span id="cb5-769"><a href="app-code.html#cb5-769" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-770"><a href="app-code.html#cb5-770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> term),</span>
<span id="cb5-771"><a href="app-code.html#cb5-771" aria-hidden="true" tabindex="-1"></a>    <span class="at">hjust =</span> <span class="fl">1.03</span>,</span>
<span id="cb5-772"><a href="app-code.html#cb5-772" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb5-773"><a href="app-code.html#cb5-773" aria-hidden="true" tabindex="-1"></a>    <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>,</span>
<span id="cb5-774"><a href="app-code.html#cb5-774" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">&quot;IBMPlexSans&quot;</span></span>
<span id="cb5-775"><a href="app-code.html#cb5-775" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-776"><a href="app-code.html#cb5-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb5-777"><a href="app-code.html#cb5-777" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb5-778"><a href="app-code.html#cb5-778" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1250</span>)</span>
<span id="cb5-779"><a href="app-code.html#cb5-779" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb5-780"><a href="app-code.html#cb5-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>)</span>
<span id="cb5-781"><a href="app-code.html#cb5-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-782"><a href="app-code.html#cb5-782" aria-hidden="true" tabindex="-1"></a>stm_count_topic_word_graph</span>
<span id="cb5-783"><a href="app-code.html#cb5-783" aria-hidden="true" tabindex="-1"></a>gamma_term <span class="sc">%&gt;%</span></span>
<span id="cb5-784"><a href="app-code.html#cb5-784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">theta =</span> gamma) <span class="sc">%&gt;%</span></span>
<span id="cb5-785"><a href="app-code.html#cb5-785" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">&quot;Document-Topic prevalence in the corpus with the top 6 words that contribute to each topic.&quot;</span>, <span class="at">format =</span> <span class="st">&quot;markdown&quot;</span>)</span>
<span id="cb5-786"><a href="app-code.html#cb5-786" aria-hidden="true" tabindex="-1"></a><span class="co"># gt::gt()</span></span>
<span id="cb5-787"><a href="app-code.html#cb5-787" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting</span></span>
<span id="cb5-788"><a href="app-code.html#cb5-788" aria-hidden="true" tabindex="-1"></a>stm<span class="sc">::</span><span class="fu">plot.topicCorr</span>(mod.out.corr)</span>
<span id="cb5-789"><a href="app-code.html#cb5-789" aria-hidden="true" tabindex="-1"></a><span class="do">## D3 version:</span></span>
<span id="cb5-790"><a href="app-code.html#cb5-790" aria-hidden="true" tabindex="-1"></a><span class="do">## Making dfm object:</span></span>
<span id="cb5-791"><a href="app-code.html#cb5-791" aria-hidden="true" tabindex="-1"></a>df_dfm <span class="ot">&lt;-</span> df_bow <span class="sc">%&gt;%</span></span>
<span id="cb5-792"><a href="app-code.html#cb5-792" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(document, word) <span class="sc">%&gt;%</span></span>
<span id="cb5-793"><a href="app-code.html#cb5-793" aria-hidden="true" tabindex="-1"></a>  tidytext<span class="sc">::</span><span class="fu">cast_dfm</span>(document, word, n)</span>
<span id="cb5-794"><a href="app-code.html#cb5-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-795"><a href="app-code.html#cb5-795" aria-hidden="true" tabindex="-1"></a>stm_document <span class="ot">&lt;-</span> quanteda<span class="sc">::</span><span class="fu">convert</span>(df_dfm, <span class="at">to =</span> <span class="st">&quot;stm&quot;</span>)</span>
<span id="cb5-796"><a href="app-code.html#cb5-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-797"><a href="app-code.html#cb5-797" aria-hidden="true" tabindex="-1"></a>stmCorrViz<span class="sc">::</span><span class="fu">stmCorrViz</span>(stm_optimal_model, <span class="st">&quot;stm-interactive-correlation.html&quot;</span>,</span>
<span id="cb5-798"><a href="app-code.html#cb5-798" aria-hidden="true" tabindex="-1"></a>  <span class="at">documents_raw =</span> covariate_df<span class="sc">$</span>content, <span class="at">documents_matrix =</span> stm_document<span class="sc">$</span>documents</span>
<span id="cb5-799"><a href="app-code.html#cb5-799" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-800"><a href="app-code.html#cb5-800" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb5-801"><a href="app-code.html#cb5-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-802"><a href="app-code.html#cb5-802" aria-hidden="true" tabindex="-1"></a><span class="co"># y-axis labels are a little smooshed together so print 3-step interval instead</span></span>
<span id="cb5-803"><a href="app-code.html#cb5-803" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">40</span>)</span>
<span id="cb5-804"><a href="app-code.html#cb5-804" aria-hidden="true" tabindex="-1"></a>labels[<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">3</span>)</span>
<span id="cb5-805"><a href="app-code.html#cb5-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-806"><a href="app-code.html#cb5-806" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> gamma_year <span class="sc">%&gt;%</span></span>
<span id="cb5-807"><a href="app-code.html#cb5-807" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stm_df_topic() %&gt;%</span></span>
<span id="cb5-808"><a href="app-code.html#cb5-808" aria-hidden="true" tabindex="-1"></a>  <span class="co"># count(year, topic) %&gt;%</span></span>
<span id="cb5-809"><a href="app-code.html#cb5-809" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left_join(stm_top_terms, by = &quot;topic&quot;) %&gt;%</span></span>
<span id="cb5-810"><a href="app-code.html#cb5-810" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(year = as.factor(year), topic = as.factor(topic)) %&gt;%</span></span>
<span id="cb5-811"><a href="app-code.html#cb5-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(year, topic, <span class="at">fill =</span> gamma, <span class="at">text =</span> term)) <span class="sc">+</span></span>
<span id="cb5-812"><a href="app-code.html#cb5-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb5-813"><a href="app-code.html#cb5-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-814"><a href="app-code.html#cb5-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> labels) <span class="sc">+</span></span>
<span id="cb5-815"><a href="app-code.html#cb5-815" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_distiller(palette = &quot;RdPu&quot;) +</span></span>
<span id="cb5-816"><a href="app-code.html#cb5-816" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_viridis(discrete = FALSE) +</span></span>
<span id="cb5-817"><a href="app-code.html#cb5-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="fu">expression</span>(theta)) <span class="sc">+</span></span>
<span id="cb5-818"><a href="app-code.html#cb5-818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb5-819"><a href="app-code.html#cb5-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb5-820"><a href="app-code.html#cb5-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-821"><a href="app-code.html#cb5-821" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (knitr<span class="sc">::</span><span class="fu">is_html_output</span>()) {</span>
<span id="cb5-822"><a href="app-code.html#cb5-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(plotly)</span>
<span id="cb5-823"><a href="app-code.html#cb5-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-824"><a href="app-code.html#cb5-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplotly</span>(p, <span class="at">tooltip =</span> <span class="st">&quot;text&quot;</span>)</span>
<span id="cb5-825"><a href="app-code.html#cb5-825" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb5-826"><a href="app-code.html#cb5-826" aria-hidden="true" tabindex="-1"></a>  p</span>
<span id="cb5-827"><a href="app-code.html#cb5-827" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-828"><a href="app-code.html#cb5-828" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hrbrthemes)</span>
<span id="cb5-829"><a href="app-code.html#cb5-829" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb5-830"><a href="app-code.html#cb5-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-831"><a href="app-code.html#cb5-831" aria-hidden="true" tabindex="-1"></a><span class="co"># y-axis labels are a little smooshed together so print 3-step interval instead</span></span>
<span id="cb5-832"><a href="app-code.html#cb5-832" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">40</span>)</span>
<span id="cb5-833"><a href="app-code.html#cb5-833" aria-hidden="true" tabindex="-1"></a>labels[<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">3</span>)</span>
<span id="cb5-834"><a href="app-code.html#cb5-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-835"><a href="app-code.html#cb5-835" aria-hidden="true" tabindex="-1"></a>p_list <span class="ot">&lt;-</span> gamma_list <span class="sc">%&gt;%</span></span>
<span id="cb5-836"><a href="app-code.html#cb5-836" aria-hidden="true" tabindex="-1"></a>  <span class="co"># stm_df_topic() %&gt;%</span></span>
<span id="cb5-837"><a href="app-code.html#cb5-837" aria-hidden="true" tabindex="-1"></a>  <span class="co"># count(year, topic) %&gt;%</span></span>
<span id="cb5-838"><a href="app-code.html#cb5-838" aria-hidden="true" tabindex="-1"></a>  <span class="co"># left_join(stm_top_terms, by = &quot;topic&quot;) %&gt;%</span></span>
<span id="cb5-839"><a href="app-code.html#cb5-839" aria-hidden="true" tabindex="-1"></a>  <span class="co"># mutate(year = as.factor(year), topic = as.factor(topic)) %&gt;%</span></span>
<span id="cb5-840"><a href="app-code.html#cb5-840" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(list, topic, <span class="at">fill =</span> gamma, <span class="at">text =</span> term)) <span class="sc">+</span></span>
<span id="cb5-841"><a href="app-code.html#cb5-841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb5-842"><a href="app-code.html#cb5-842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb5-843"><a href="app-code.html#cb5-843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> labels) <span class="sc">+</span></span>
<span id="cb5-844"><a href="app-code.html#cb5-844" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_distiller(palette = &quot;RdPu&quot;) +</span></span>
<span id="cb5-845"><a href="app-code.html#cb5-845" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_fill_viridis(discrete = FALSE) +</span></span>
<span id="cb5-846"><a href="app-code.html#cb5-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="fu">expression</span>(theta)) <span class="sc">+</span></span>
<span id="cb5-847"><a href="app-code.html#cb5-847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_ipsum</span>() <span class="sc">+</span></span>
<span id="cb5-848"><a href="app-code.html#cb5-848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb5-849"><a href="app-code.html#cb5-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-850"><a href="app-code.html#cb5-850" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (knitr<span class="sc">::</span><span class="fu">is_html_output</span>()) {</span>
<span id="cb5-851"><a href="app-code.html#cb5-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(plotly)</span>
<span id="cb5-852"><a href="app-code.html#cb5-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-853"><a href="app-code.html#cb5-853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplotly</span>(p_list, <span class="at">tooltip =</span> <span class="st">&quot;text&quot;</span>)</span>
<span id="cb5-854"><a href="app-code.html#cb5-854" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb5-855"><a href="app-code.html#cb5-855" aria-hidden="true" tabindex="-1"></a>  p_list</span>
<span id="cb5-856"><a href="app-code.html#cb5-856" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>

<!--
The bib chunk below must go last in this document according to how R Markdown renders.  More info is at http://rmarkdown.rstudio.com/authoring_bibliographies_and_citations.html
-->
<!-- 
If you'd like to change the name of the bibliography to something else,
delete "References" and replace it.
-->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="app-table.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["dissertation.epub", "dissertation.docx"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
